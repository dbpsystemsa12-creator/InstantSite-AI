<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DBP InstantSite AI | Professional Site Builder</title>
    
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyC24Zu9brLtaqc1SczdbJeVx5byV9KdWwA",
            authDomain: "instantsite-ai.firebaseapp.com",
            projectId: "instantsite-ai",
            storageBucket: "instantsite-ai.firebasestorage.app",
            messagingSenderId: "669282499799",
            appId: "1:669282499799:web:9fe07b3bdfcc8da3acc492"
        };
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const db = firebase.firestore();
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'], display: ['Outfit', 'sans-serif'], mono: ['JetBrains Mono', 'monospace'] },
                    colors: { brand: { 400: '#a855f7', 500: '#8b5cf6', 600: '#7c3aed' }, dark: { 900: '#0a0a0a', 950: '#030303' } },
                    animation: { 'spin-slow': 'spin 8s linear infinite', 'blob': 'blob 7s infinite', 'fade-up': 'fadeUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards', 'shimmer': 'shimmer 3s linear infinite', 'glow-pulse': 'glowPulse 4s ease-in-out infinite' },
                    keyframes: {
                        blob: { '0%, 100%': { transform: 'translate(0px, 0px) scale(1)' }, '33%': { transform: 'translate(30px, -50px) scale(1.1)' }, '66%': { transform: 'translate(-20px, 20px) scale(0.9)' } },
                        fadeUp: { '0%': { opacity: 0, transform: 'translateY(30px)' }, '100%': { opacity: 1, transform: 'translateY(0)' } },
                        shimmer: { '0%': { backgroundPosition: '-200% 0' }, '100%': { backgroundPosition: '200% 0' } },
                        glowPulse: { '0%, 100%': { opacity: 0.3 }, '50%': { opacity: 0.6 } }
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@300;400;600;800;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        html { scroll-behavior: smooth; }
        body { font-family: 'Inter', sans-serif; background-color: #030303; color: #f8fafc; overflow: hidden; }
        h1, h2, h3, h4, h5 { font-family: 'Outfit', sans-serif; letter-spacing: -0.02em; }
        
        .bg-grid { background-image: linear-gradient(to right, rgba(255,255,255,0.03) 1px, transparent 1px), linear-gradient(to bottom, rgba(255,255,255,0.03) 1px, transparent 1px); background-size: 50px 50px; }
        .hero-glow { position: absolute; top: -10%; left: 50%; transform: translateX(-50%); width: 100vw; max-width: 800px; height: 400px; background: radial-gradient(ellipse at center, rgba(139, 92, 246, 0.15) 0%, transparent 70%); pointer-events: none; z-index: 0; }

        .premium-panel { background: linear-gradient(145deg, rgba(20,20,22,0.8), rgba(10,10,12,0.95)); backdrop-filter: blur(40px); border: 1px solid rgba(255, 255, 255, 0.08); box-shadow: 0 30px 60px rgba(0,0,0,0.8), inset 0 1px 0 rgba(255,255,255,0.1); border-radius: 1.5rem; }
        .glass-sidebar { background: rgba(10, 10, 10, 0.4); backdrop-filter: blur(24px); border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 2rem; }
        .glass-nav { background: rgba(3,3,3,0.7); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(255, 255, 255, 0.05); z-index: 60; }

        .pro-badge { background: linear-gradient(135deg, #fbbf24, #f59e0b); color: #000; font-weight: 900; font-size: 0.75rem; padding: 0.25rem 0.85rem; border-radius: 0.4rem; text-transform: uppercase; letter-spacing: 0.15em; box-shadow: 0 0 20px rgba(245, 158, 11, 0.5), inset 0 1px 1px rgba(255,255,255,0.5); display: inline-flex; align-items: center; justify-content: center; border: 1px solid #78350f; transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); }

        .input-wrapper { position: relative; display: flex; align-items: center; width: 100%; height: 100%; }
        .input-icon { position: absolute; left: 1rem; color: #64748b; font-size: 0.9rem; pointer-events: none; z-index: 10; }
        .textarea-icon { top: 1rem; align-items: flex-start; }
        .input-glass { background: rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.1); color: white; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); width: 100%; padding: 0.8rem 1rem 0.8rem 2.5rem !important; border-radius: 0.75rem; box-shadow: inset 0 2px 5px rgba(0,0,0,0.5); font-family: 'Inter', sans-serif; font-size: 0.85rem; }
        .input-glass-no-icon { padding-left: 1rem !important; }
        .input-wrapper:focus-within .input-icon { color: #a855f7; text-shadow: 0 0 12px rgba(168, 85, 247, 0.6); }
        .input-glass:focus { background: rgba(255,255,255,0.05); border-color: #8b5cf6; box-shadow: inset 0 2px 4px rgba(0,0,0,0.5), 0 0 0 2px rgba(139, 92, 246, 0.2); outline: none; }
        
        .btn-shine { position: relative; overflow: hidden; background: linear-gradient(90deg, #7c3aed, #a855f7, #7c3aed); background-size: 200% 100%; animation: shimmer 3s infinite linear; border: 1px solid rgba(255,255,255,0.2); box-shadow: 0 10px 30px rgba(139, 92, 246, 0.25), inset 0 1px 0 rgba(255,255,255,0.3); border-radius: 0.75rem; color: white; font-weight: 800; letter-spacing: 0.05em; text-transform: uppercase; transition: transform 0.3s ease; }
        .btn-shine:hover { transform: translateY(-2px); box-shadow: 0 15px 40px rgba(168, 85, 247, 0.4), inset 0 1px 0 rgba(255,255,255,0.4); }
        .btn-secondary { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 0.75rem; color: white; font-weight: 600; transition: all 0.3s ease; }
        .btn-secondary:hover { background: rgba(255,255,255,0.08); border-color: rgba(255,255,255,0.2); }

        .nav-item { width: 3.5rem; height: 3.5rem; display: flex; align-items: center; justify-content: center; border-radius: 1rem; color: #64748b; font-size: 1.25rem; transition: all 0.3s ease; position: relative; }
        .nav-item:hover { background: rgba(255,255,255,0.05); color: #fff; }
        .nav-item.active { background: rgba(139, 92, 246, 0.15); color: #a855f7; border: 1px solid rgba(139, 92, 246, 0.3); box-shadow: 0 0 20px rgba(139, 92, 246, 0.2); }
        .nav-tooltip { position: absolute; left: 120%; background: #fff; color: #000; padding: 0.4rem 0.8rem; font-size: 0.75rem; font-weight: bold; border-radius: 0.5rem; opacity: 0; pointer-events: none; transform: translateX(-10px); transition: all 0.2s ease; white-space: nowrap; font-family: 'Inter', sans-serif; letter-spacing: 0.05em; z-index: 100;}
        .nav-item:hover .nav-tooltip { opacity: 1; transform: translateX(0); }

        .terminal-window { background: #000; border: 1px solid #1e293b; border-radius: 12px; overflow: hidden; box-shadow: 0 0 40px rgba(16, 185, 129, 0.1); }
        .hacker-text { font-family: 'JetBrains Mono', monospace; color: #10b981; text-shadow: 0 0 5px rgba(16, 185, 129, 0.4); font-size: 13px; line-height: 1.6; }
        
        .preview-outer-wrapper { flex: 1; overflow-y: auto; overflow-x: hidden; background: rgba(0,0,0,0.3); display: flex; flex-direction: column; align-items: center; padding: 3rem 1rem 8rem 1rem; position: relative; }
        .preview-outer-wrapper::-webkit-scrollbar { width: 8px; }
        .preview-outer-wrapper::-webkit-scrollbar-track { background: rgba(0,0,0,0.2); }
        .preview-outer-wrapper::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 4px; }
        
        .device-morph { position: relative; background: #000; display: flex; flex-direction: column; flex-shrink: 0; overflow: hidden; transition: all 0.7s cubic-bezier(0.16, 1, 0.3, 1); box-shadow: 0 0 0 2px #262626, 0 40px 80px rgba(0,0,0,0.9); margin: 0 auto; box-sizing: border-box; }
        .mode-mobile { width: 375px; max-width: 95vw; height: 812px; border: 12px solid #141414; border-radius: 40px; }
        .mode-desktop { width: 100%; max-width: 1200px; height: 85vh; min-height: 600px; border: 12px solid #141414; border-bottom-width: 24px; border-radius: 12px 12px 0 0; }

        .device-camera { position: absolute; left: 50%; transform: translateX(-50%); background: #000; z-index: 50; transition: all 0.7s cubic-bezier(0.16, 1, 0.3, 1); }
        .mode-mobile .device-camera { top: 12px; width: 100px; height: 28px; border-radius: 20px; box-shadow: inset 0 0 4px rgba(255,255,255,0.2); }
        .mode-desktop .device-camera { top: 6px; width: 6px; height: 6px; border-radius: 50%; box-shadow: inset 0 0 2px rgba(255,255,255,0.5); }

        .mobile-home-indicator { position: absolute; bottom: 12px; left: 50%; transform: translateX(-50%); width: 120px; height: 4px; background: rgba(255,255,255,0.8); border-radius: 10px; z-index: 50; mix-blend-mode: difference; opacity: 0; transition: opacity 0.4s; pointer-events: none; }
        .mode-mobile .mobile-home-indicator { opacity: 1; }

        .desktop-base-wrapper { width: 100%; max-width: 1200px; display: flex; justify-content: center; opacity: 0; height: 0; transition: all 0.7s cubic-bezier(0.16, 1, 0.3, 1); overflow: visible; margin: 0 auto; }
        .desktop-active.desktop-base-wrapper { opacity: 1; height: 24px; }
        .desktop-base { width: 104%; height: 100%; background: linear-gradient(to bottom, #d4d4d4, #737373); border-radius: 0 0 12px 12px; position: relative; box-shadow: inset 0 2px 0 rgba(255,255,255,0.6), 0 30px 60px rgba(0,0,0,0.9); margin-top: -2px; flex-shrink: 0; }
        
        .browser-bar { background: #111; display: flex; align-items: center; justify-content: center; border-bottom: 1px solid #222; z-index: 40; transition: all 0.7s cubic-bezier(0.16, 1, 0.3, 1); }
        .mode-desktop .browser-bar { height: 40px; padding: 0 16px; }
        .mode-mobile .browser-bar { height: 0; opacity: 0; overflow: hidden; border-bottom: none; }

        #dbp-splash { position: fixed; inset: 0; z-index: 999999; background: #000; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.8s ease, visibility 0.8s; }
        .splash-logo { width: 80px; height: 80px; background: linear-gradient(135deg, #a855f7, #6366f1); border-radius: 20px; display: flex; align-items: center; justify-content: center; color: white; font-family: 'Outfit', sans-serif; font-size: 2.5rem; font-weight: 900; animation: spin-flash 1.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards; box-shadow: 0 0 40px rgba(139, 92, 246, 0.3); }
        @keyframes spin-flash { 0% { transform: scale(0) rotate(-180deg); opacity: 0; } 50% { transform: scale(1.2) rotate(10deg); opacity: 1; box-shadow: 0 0 80px rgba(168, 85, 247, 0.6); } 100% { transform: scale(1) rotate(0deg); opacity: 1; } }
        .toast-enter { animation: toastIn 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes toastIn { from { transform: translate(-50%, -100%); opacity: 0; } to { transform: translate(-50%, 0); opacity: 1; } }

        .toggle-checkbox:checked { right: 0; border-color: #8b5cf6; }
        .toggle-checkbox:checked + .toggle-label { background-color: #8b5cf6; }
        
        .loader-overlay { background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(12px); position: fixed; inset: 0; z-index: 9999999; display: flex; flex-direction: column; align-items: center; justify-content: center; animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="font-sans antialiased overflow-hidden">

    <div id="dbp-splash">
        <div class="splash-logo mb-6">D</div>
        <div class="flex items-center gap-2 overflow-hidden">
            <h1 class="font-display font-bold text-2xl tracking-widest text-white uppercase translate-y-full opacity-0 animate-[fadeUp_0.5s_ease_0.8s_forwards]">DBP Systems</h1>
        </div>
        <div class="w-48 h-0.5 bg-gray-900 mt-6 relative overflow-hidden">
            <div class="absolute top-0 left-0 h-full bg-brand-500 animate-[progress_1.5s_ease_1s_forwards]" style="width: 0%; @keyframes progress { to { width: 100%; } }"></div>
        </div>
    </div>

    <div id="root" class="h-screen flex flex-col bg-grid"></div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- SMART COPY ENGINE WITH ANTI-REPETITION ---
        const seedRandom = (seedStr) => {
            let h = 0xdeadbeef;
            for(let i = 0; i < seedStr.length; i++) { h = Math.imul(h ^ seedStr.charCodeAt(i), 2654435761); }
            return function() { h ^= h << 13; h ^= h >>> 17; h ^= h << 5; return ((h < 0 ? ~h + 1 : h) % 100000) / 100000; };
        };

        const generateSmartCopy = (name, type, city, description, rawPricing) => {
            const rng = seedRandom(name + type + city);
            
            // Utility to pick and instantly remove so duplicates never happen
            const pickAndRemove = (arr, fallback) => {
                if(arr.length === 0) return fallback;
                const index = Math.floor(rng() * arr.length);
                return arr.splice(index, 1)[0];
            };
            const pick = (arr) => arr[Math.floor(rng() * arr.length)];
            
            const t = type.toLowerCase();
            let headline, subhead, about;

            let faqPool = [
                { q: `What areas do you serve?`, a: `We proudly serve ${city} and the surrounding regions with our specialized ${type} services.` },
                { q: `How can I book a consultation?`, a: `Simply fill out the contact form below or click the WhatsApp button anywhere on our site.` },
                { q: `Do you specialize in ${type}?`, a: `Absolutely. ${name} was founded specifically to provide top-tier solutions backed by years of experience.` },
                { q: `What are your operating hours?`, a: `We are available to accommodate your schedule. Please send us a quick message to confirm our specific availability.` },
                { q: `Is there a guarantee on your work?`, a: `Yes, we prioritize 100% client satisfaction and ensure our work meets the highest industry standards.` },
                { q: `Can you handle custom requests?`, a: `Definitely. We tailor all of our services to meet the specific requirements of our clients.` }
            ];

            let namesPool = ["Arjun M.", "Priya S.", "Rahul T.", "Sneha K.", "Vikram R.", "Ananya L.", "Karan B.", "Riya D.", "Neha W.", "Amit P.", "Siddharth N.", "Tara V."];
            let reviewsPool = [
                `Absolutely phenomenal experience! The team at ${name} exceeded all my expectations.`,
                `Best in ${city}! Highly recommended.`, 
                `Incredible attention to detail.`,
                `If you need reliable ${type}, look no further. Professional, fast, and transparent.`,
                `Saved me so much time and hassle. 10/10.`,
                `Very professional service in ${city}.`,
                `I've worked with many professionals, but their attention to detail is unmatched.`,
                `Great pricing and even better quality.`,
                `Will definitely be coming back for future needs.`
            ];

            let faqs = [
                pickAndRemove(faqPool, {q:"Any questions?", a:"Contact us!"}), 
                pickAndRemove(faqPool, {q:"Any questions?", a:"Contact us!"}), 
                pickAndRemove(faqPool, {q:"Any questions?", a:"Contact us!"})
            ];
            let testimonials = [
                { name: pickAndRemove(namesPool, "Client"), text: pickAndRemove(reviewsPool, "Great service!"), rating: 5 },
                { name: pickAndRemove(namesPool, "Client"), text: pickAndRemove(reviewsPool, "Highly recommended."), rating: 5 },
                { name: pickAndRemove(namesPool, "Client"), text: pickAndRemove(reviewsPool, "Very professional."), rating: 5 }
            ];

            let baseText = rawPricing || "999";
            let baseNum = parseInt(baseText.replace(/[^0-9]/g, ''));
            let p1, p2, p3;
            if(!isNaN(baseNum) && baseNum > 0) {
                p1 = '₹' + baseNum; p2 = '₹' + Math.round(baseNum * 2.5); p3 = '₹' + Math.round(baseNum * 5);
            } else {
                p1 = baseText; p2 = "Custom"; p3 = "Enterprise";
            }

            let pricing = [
                { name: 'Starter', price: p1, desc: 'Perfect for standard needs.', f1: 'Standard Service', f2: 'Basic Support', f3: '3-Day Turnaround' },
                { name: 'Professional', price: p2, desc: 'Our most popular package.', f1: 'Premium Quality', f2: 'Priority Support', f3: '1-Day Turnaround' },
                { name: 'Enterprise', price: p3, desc: 'The ultimate VIP experience.', f1: 'Unlimited Access', f2: '24/7 Dedicated Support', f3: 'Instant Priority' }
            ];

            if (t.includes('tech') || t.includes('repair') || t.includes('software') || t.includes('it')) {
                headline = pick([`Next-Generation <span class="text-brand">${type}</span>.`, `Empowering your digital life in <span class="text-brand">${city}</span>.`, `Advanced <span class="text-brand">Technology</span> Solutions.`]);
                subhead = pick([`Fast, reliable, and expertly engineered solutions for your digital life in ${city}.`, `Precision ${type} services delivered by certified engineers.`, `Seamless integration and rapid deployment for modern needs.`]);
                about = description || `At ${name}, we understand that technology drives your day. Our certified experts utilize state-of-the-art tools to deliver precision solutions, ensuring minimal downtime and maximum performance.`;
            } else if (t.includes('food') || t.includes('restaurant') || t.includes('cafe') || t.includes('bakery')) {
                headline = pick([`Savor the <span class="text-brand">Exceptional</span>.`, `Taste the magic of <span class="text-brand">${city}</span>.`, `Authentic <span class="text-brand">Culinary</span> Experiences.`]);
                subhead = pick([`Experience culinary mastery and unforgettable flavors, right here in ${city}.`, `Handcrafted ${type} made with passion and premium ingredients.`, `Your new favorite spot for delicious moments.`]);
                about = description || `Welcome to ${name}. We source the finest ingredients and pour passion into every recipe. Whether you are seeking a quick bite or a memorable dining experience, our commitment to quality is evident in every detail.`;
            } else if (t.includes('health') || t.includes('clinic') || t.includes('fitness') || t.includes('gym')) {
                headline = pick([`Your Wellness, <span class="text-brand">Elevated</span>.`, `Transform your health in <span class="text-brand">${city}</span>.`, `Dedicated to your <span class="text-brand">Well-being</span>.`]);
                subhead = pick([`Compassionate care and expert health services dedicated to the ${city} community.`, `Achieve your peak potential with our specialized ${type} programs.`, `Modern practices combined with traditional care.`]);
                about = description || `${name} is founded on the principle of holistic well-being. Our experienced professionals provide personalized care, utilizing modern practices to help you achieve and maintain your optimal health goals.`;
            } else {
                headline = pick([`Excellence in <span class="text-brand">Every Detail</span>.`, `The premier destination for <span class="text-brand">${type}</span>.`, `Setting the standard in <span class="text-brand">${city}</span>.`]);
                subhead = pick([`The premier destination for professional ${type} services in ${city}.`, `Uncompromising quality and dedicated service tailored to you.`, `Your trusted partner for all ${type} requirements.`]);
                about = description || `At ${name}, we pride ourselves on delivering an uncompromising standard of quality. Our dedicated team brings years of industry expertise to provide bespoke solutions that consistently exceed client expectations.`;
            }
            return { headline, subhead, about, pricing, faqs, testimonials };
        };

        // --- CORE HTML COMPILER ---
        const generateSiteHTML = (data, isPro) => {
            const copy = generateSmartCopy(data.name, data.type, data.city, data.description, data.pricingDetails);
            
            // ANTI-REPETITION LOGIC FOR SERVICES
            let userServices = data.services && isPro ? data.services.split(',').map(s => s.trim()).filter(s => s.length > 0) : [];
            let defaultServices = ['Premium Quality Integration', 'Rapid Turnaround Times', 'Expert Strategy Consultations', '24/7 Dedicated Support', 'Custom Architecture', 'Priority Workflow', 'Comprehensive Analytics'];
            let finalServices = [...new Set(userServices)]; 
            
            let svcIndex = 0;
            while(finalServices.length < 4 && svcIndex < defaultServices.length) {
                let candidate = defaultServices[svcIndex];
                if (!finalServices.some(s => s.toLowerCase() === candidate.toLowerCase())) {
                    finalServices.push(candidate);
                }
                svcIndex++;
            }

            const validTemplates = ['minimal', 'bento', 'dark', 'corporate', 'creative', 'neon', 'midnight', 'matrix', 'glassmorphism', 'brutalism', 'ai-dark', 'ai-light'];
            const t = isPro ? (validTemplates.includes(data.template) ? data.template : 'minimal') : (['bento', 'minimal'].includes(data.template) ? data.template : 'minimal'); 
            const mainColor = data.color || '#a855f7';

            let fontName = 'Outfit', fontImport = 'Outfit:wght@300;400;600;800;900';
            let bodyClass='', navClass='', headClass='', subClass='', sectionBg1='', sectionBg2='', radiusClass='', cardClass='', customCSS='';

            // ARCHITECTURE ASSIGNMENT
            let isBento = t === 'bento' || t === 'creative';
            let isBrutalist = t === 'brutalism';
            let isDark = ['dark', 'neon', 'midnight', 'matrix', 'ai-dark'].includes(t);
            let isCorporate = t === 'corporate';
            let isGlass = t === 'glassmorphism';

            if (t === 'minimal') {
                fontName = 'Inter'; fontImport = 'Inter:wght@300;400;600;800';
                bodyClass = 'bg-white text-gray-800'; navClass = 'bg-white/90 border-b border-gray-100 text-gray-900'; 
                headClass = 'text-gray-900'; subClass = 'text-gray-500';
                sectionBg1 = 'bg-white'; sectionBg2 = 'bg-gray-50'; radiusClass = 'rounded-none';
                cardClass = 'bg-white border border-gray-200 hover:-translate-y-1 hover:shadow-xl text-gray-600 transition-all duration-300';
                customCSS = `.hero-bg { background-image: radial-gradient(${mainColor} 1px, transparent 1px); background-size: 40px 40px; background-color: #fafafa; }`;
            } else if (t === 'bento') {
                bodyClass = 'bg-[#f8fafc] text-slate-800'; navClass = 'bg-white/80 border-b border-slate-200 text-slate-900'; 
                headClass = 'text-slate-900'; subClass = 'text-slate-500';
                sectionBg1 = 'bg-white'; sectionBg2 = 'bg-[#f8fafc]'; radiusClass = 'rounded-[2rem]';
                cardClass = 'bg-white border border-slate-100 hover:-translate-y-2 hover:shadow-2xl hover:border-brand-light text-slate-600 transition-all duration-300';
                customCSS = `.hero-bg { background: linear-gradient(135deg, #ffffff, #f1f5f9); }`;
            } else if (t === 'ai-dark') {
                fontName = 'Inter'; fontImport = 'Inter:wght@300;400;500;600;800';
                bodyClass = 'bg-black text-gray-400'; navClass = 'bg-black/50 backdrop-blur-2xl border-b border-white/5 text-white';
                headClass = 'text-transparent bg-clip-text bg-gradient-to-r from-white to-gray-500'; 
                subClass = 'text-gray-400 font-light';
                sectionBg1 = 'bg-black'; sectionBg2 = 'bg-[#050505]'; radiusClass = 'rounded-[2rem]';
                cardClass = 'bg-white/[0.02] border border-white/5 hover:bg-white/[0.04] transition-all duration-500 shadow-[inset_0_1px_0_0_rgba(255,255,255,0.1)]';
                customCSS = `.hero-bg { background: radial-gradient(circle at 50% 0%, ${mainColor}30, transparent 50%), radial-gradient(circle at 50% 100%, ${mainColor}10, transparent 50%); } .brand-glow { text-shadow: 0 0 40px ${mainColor}80; }`;
            } else if (t === 'ai-light') {
                fontName = 'Inter'; fontImport = 'Inter:wght@300;400;500;600;800';
                bodyClass = 'bg-[#fbfbfd] text-[#1d1d1f]'; navClass = 'bg-white/70 backdrop-blur-2xl border-b border-black/5 text-[#1d1d1f]';
                headClass = 'text-[#1d1d1f] tracking-tighter'; 
                subClass = 'text-[#86868b] font-medium';
                sectionBg1 = 'bg-[#fbfbfd]'; sectionBg2 = 'bg-white'; radiusClass = 'rounded-[2rem]';
                cardClass = 'bg-white border border-black/[0.04] hover:shadow-[0_20px_40px_-15px_rgba(0,0,0,0.05)] transition-all duration-500';
                customCSS = `.hero-bg { background: radial-gradient(circle at top center, ${mainColor}15, transparent 50%); }`;
            } else if (t === 'dark') {
                fontName = 'Space Grotesk'; fontImport = 'Space+Grotesk:wght@400;600;700';
                bodyClass = 'bg-[#050505] text-gray-300'; navClass = 'bg-black/70 border-b border-white/5 text-white'; 
                headClass = 'text-white'; subClass = 'text-gray-400';
                sectionBg1 = 'bg-[#0a0a0a]'; sectionBg2 = 'bg-[#111111]'; radiusClass = 'rounded-2xl';
                cardClass = 'bg-[#171717] border border-[#262626] hover:-translate-y-1 hover:border-brand shadow-lg text-gray-300 transition-all duration-300';
                customCSS = `.hero-bg { background: radial-gradient(circle at top right, ${mainColor}20, transparent 40%), radial-gradient(circle at bottom left, ${mainColor}10, transparent 40%); }`;
            } else if (t === 'neon') {
                fontName = 'Space Grotesk'; fontImport = 'Space+Grotesk:wght@400;600;700';
                bodyClass = 'bg-[#09090b] text-zinc-300'; navClass = 'bg-[#09090b]/90 border-b border-zinc-800 text-white'; 
                headClass = 'text-white'; subClass = 'text-zinc-400';
                sectionBg1 = 'bg-[#09090b]'; sectionBg2 = 'bg-[#18181b]'; radiusClass = 'rounded-none';
                cardClass = 'bg-[#09090b] border border-zinc-800 hover:-translate-y-1 hover:border-brand hover:shadow-[0_0_20px_var(--tw-shadow-color)] shadow-brand text-zinc-300 transition-all duration-300';
                customCSS = `.hero-bg { background: #09090b; } .text-brand { text-shadow: 0 0 15px ${mainColor}; }`;
            } else if (t === 'midnight') {
                fontName = 'Outfit'; fontImport = 'Outfit:wght@300;400;600;800';
                bodyClass = 'bg-[#020617] text-slate-300'; navClass = 'bg-[#020617]/80 border-b border-slate-800 text-slate-100'; 
                headClass = 'text-slate-50'; subClass = 'text-slate-400';
                sectionBg1 = 'bg-[#020617]'; sectionBg2 = 'bg-[#0f172a]'; radiusClass = 'rounded-2xl';
                cardClass = 'bg-[#1e293b] border border-slate-700 hover:-translate-y-1 hover:border-brand/50 text-slate-300 shadow-xl transition-all duration-300';
                customCSS = `.hero-bg { background: radial-gradient(ellipse at center, #0f172a 0%, #020617 100%); }`;
            } else if (t === 'matrix') {
                fontName = 'JetBrains Mono'; fontImport = 'JetBrains+Mono:wght@400;700;800';
                bodyClass = 'bg-black text-brand'; navClass = 'bg-black/90 border-b border-brand/30 text-brand'; 
                headClass = 'text-brand'; subClass = 'text-brand/70';
                sectionBg1 = 'bg-black'; sectionBg2 = 'bg-[#050505]'; radiusClass = 'rounded-none';
                cardClass = 'bg-black border border-brand/40 hover:-translate-y-1 hover:bg-brand/10 text-brand transition-all duration-300';
                customCSS = `.hero-bg { background-image: linear-gradient(${mainColor}10 1px, transparent 1px), linear-gradient(90deg, ${mainColor}10 1px, transparent 1px); background-size: 30px 30px; }`;
            } else if (t === 'corporate') {
                fontName = 'Inter'; fontImport = 'Inter:wght@400;600;700;900';
                bodyClass = 'bg-slate-50 text-slate-800'; navClass = 'bg-white/95 border-b border-slate-200 text-slate-900 shadow-sm'; 
                headClass = 'text-slate-900'; subClass = 'text-slate-600';
                sectionBg1 = 'bg-white'; sectionBg2 = 'bg-slate-100'; radiusClass = 'rounded-lg';
                cardClass = 'bg-white border border-slate-200 hover:-translate-y-1 hover:shadow-xl text-slate-600 transition-all duration-300';
                customCSS = `.hero-bg { background: linear-gradient(to right, #ffffff, #f8fafc); }`;
            } else if (t === 'glassmorphism') {
                fontName = 'Outfit'; fontImport = 'Outfit:wght@300;400;600;700';
                bodyClass = 'bg-white text-slate-800'; navClass = 'bg-white/40 backdrop-blur-xl border-b border-white/40 text-slate-900 shadow-sm'; 
                headClass = 'text-slate-900'; subClass = 'text-slate-600';
                sectionBg1 = 'bg-transparent'; sectionBg2 = 'bg-white/30 backdrop-blur-md'; radiusClass = 'rounded-3xl';
                cardClass = 'bg-white/40 backdrop-blur-lg border border-white/60 hover:-translate-y-1 hover:bg-white/60 text-slate-700 shadow-[0_8px_32px_0_rgba(31,38,135,0.07)] transition-all duration-300';
                customCSS = `body { background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%); min-height: 100vh; }`;
            } else if (t === 'brutalism') {
                fontName = 'Syne'; fontImport = 'Syne:wght@600;800';
                bodyClass = 'bg-[#fdfde3] text-black'; navClass = 'bg-[#fdfde3] border-b-4 border-black text-black'; 
                headClass = 'text-black font-black uppercase tracking-tight'; subClass = 'text-gray-800 font-medium';
                sectionBg1 = 'bg-[#fdfde3]'; sectionBg2 = 'bg-[#f0f0c9] border-y-4 border-black'; radiusClass = 'rounded-none';
                cardClass = 'bg-white border-4 border-black hover:-translate-y-2 hover:translate-x-2 hover:shadow-[-8px_8px_0_0_#000] text-black font-bold transition-transform duration-300';
                customCSS = `.hero-bg { background: repeating-linear-gradient( 45deg, transparent, transparent 10px, rgba(0,0,0,0.05) 10px, rgba(0,0,0,0.05) 20px ); }`;
            } else if (t === 'creative') {
                fontName = 'Syne'; fontImport = 'Syne:wght@600;800';
                bodyClass = 'bg-[#fafafa] text-gray-900'; navClass = 'bg-transparent text-gray-900'; 
                headClass = 'text-black font-black uppercase'; subClass = 'text-gray-700 font-medium';
                sectionBg1 = 'bg-brand/10'; sectionBg2 = 'bg-white'; radiusClass = 'rounded-[3rem]';
                cardClass = 'bg-white border-4 border-black hover:-translate-y-2 hover:shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] text-black font-bold transition-all duration-300';
                customCSS = `.hero-bg { background: linear-gradient(135deg, ${mainColor}20, transparent); }`;
            }

            const getImage = (id, extraKeyword='') => {
                const keyword = encodeURIComponent(`${extraKeyword} ${data.type} ${data.name} ${id} high quality professional photography cinematic`.trim());
                return `https://image.pollinations.ai/prompt/${keyword}?width=1200&height=800&nologo=true`;
            };

            const themeIcons = { tech: 'fa-microchip', food: 'fa-utensils', health: 'fa-heart-pulse', retail: 'fa-bag-shopping', default: 'fa-bolt' };
            const typeStr = data.type ? data.type.toLowerCase() : '';
            let icon = themeIcons.default;
            if(typeStr.includes('tech') || typeStr.includes('repair')) icon = themeIcons.tech;
            else if(typeStr.includes('food') || typeStr.includes('cafe')) icon = themeIcons.food;
            else if(typeStr.includes('health') || typeStr.includes('clinic')) icon = themeIcons.health;
            else if(typeStr.includes('shop') || typeStr.includes('mart')) icon = themeIcons.retail;

            const seoTags = isPro && data.seo ? `<meta name="keywords" content="${data.seo}">` : `<meta name="keywords" content="${data.type}, ${data.city}">`;
            const cleanPhone = (data.phone || '').replace(/\D/g, '');
            const encodedAddress = encodeURIComponent(data.hasAddress === 'yes' && data.address ? data.address : data.city);

            const watermarkHtml = isPro ? '' : `
            <a href="https://dbpsites.in" target="_blank" style="z-index: 9999;" class="fixed bottom-6 left-6 flex items-center gap-3 bg-[#0a0a0a]/90 backdrop-blur-xl border border-white/20 px-4 py-3 rounded-2xl shadow-2xl hover:scale-105 hover:shadow-brand transition-all w-max no-underline group">
                <div class="w-10 h-10 bg-gradient-to-br from-brand-400 to-brand-600 rounded-lg flex items-center justify-center text-white font-black text-xs shadow-lg group-hover:animate-pulse">DBP</div>
                <div class="flex flex-col hidden sm:flex">
                    <span class="text-[9px] font-bold text-gray-400 uppercase tracking-widest mb-0.5">Built with</span>
                    <span class="text-sm font-black text-white leading-none group-hover:text-brand-400 transition-colors">InstantSite AI</span>
                </div>
            </a>`;

            const whatsappWidgetHtml = `
            <a href="https://wa.me/91${cleanPhone}" target="_blank" rel="noopener noreferrer" style="z-index: 9999;" class="fixed bottom-6 right-6 bg-[#25D366] text-white w-14 h-14 rounded-full flex items-center justify-center text-3xl shadow-[0_4px_20px_rgba(37,211,102,0.4)] hover:scale-110 hover:shadow-[0_4px_25px_rgba(37,211,102,0.6)] transition-all duration-300">
                <i class="fa-brands fa-whatsapp"></i>
            </a>`;

            let navLinksHtml = `<a href="#about" class="hover:text-brand transition">About</a><a href="#services" class="hover:text-brand transition">Services</a>`;
            let mobileNavLinksHtml = `<a href="#about" class="mobile-link hover:text-brand">About</a><a href="#services" class="mobile-link hover:text-brand">Services</a>`;
            if (data.showGallery) { navLinksHtml += `<a href="#gallery" class="hover:text-brand transition">Gallery</a>`; mobileNavLinksHtml += `<a href="#gallery" class="mobile-link hover:text-brand">Gallery</a>`; }
            if (data.showTestimonials) { navLinksHtml += `<a href="#testimonials" class="hover:text-brand transition">Reviews</a>`; mobileNavLinksHtml += `<a href="#testimonials" class="mobile-link hover:text-brand">Reviews</a>`; }
            if (data.hasPricing === 'yes') { navLinksHtml += `<a href="#pricing" class="hover:text-brand transition">Pricing</a>`; mobileNavLinksHtml += `<a href="#pricing" class="mobile-link hover:text-brand">Pricing</a>`; }
            if (data.showFAQ) { navLinksHtml += `<a href="#faq" class="hover:text-brand transition">FAQ</a>`; mobileNavLinksHtml += `<a href="#faq" class="mobile-link hover:text-brand">FAQ</a>`; }
            navLinksHtml += `<a href="#contact" class="hover:text-brand transition">Contact</a>`; mobileNavLinksHtml += `<a href="#contact" class="mobile-link hover:text-brand">Contact</a>`;

            let heroContentHtml = '';
            let aboutHtml = '';
            let servicesHtml = '';

            if (isBrutalist) {
                heroContentHtml = `
                <div class="w-full relative z-10 py-20 border-b-8 border-black bg-brand" data-aos="fade-up">
                    <div class="overflow-hidden whitespace-nowrap bg-black text-brand py-4 border-y-8 border-black w-full mb-10 transform -rotate-2 scale-105">
                        <h2 class="font-display font-black text-4xl uppercase tracking-widest inline-block animate-shimmer" style="animation: marquee 15s linear infinite;">${copy.headline.replace(/<[^>]*>?/gm, '')} // ${data.city} // ${copy.headline.replace(/<[^>]*>?/gm, '')} // ${data.city} //</h2>
                    </div>
                    <div class="max-w-7xl mx-auto px-6 text-center">
                        <h2 class="font-display text-6xl md:text-[8rem] font-black mb-6 tracking-tighter leading-[0.9] ${headClass} uppercase drop-shadow-[-8px_8px_0_rgba(0,0,0,1)]">${copy.headline}</h2>
                        <p class="text-xl md:text-3xl mb-12 font-bold leading-snug max-w-3xl mx-auto ${subClass} bg-white p-4 border-4 border-black shadow-[-8px_8px_0_0_#000]">${copy.subhead}</p>
                        <a href="#contact" class="inline-block bg-black text-white px-12 py-6 border-4 border-black font-black text-2xl hover:bg-white hover:text-black transition-all shadow-[-8px_8px_0_0_#fff]">START NOW</a>
                    </div>
                </div>`;
                
                aboutHtml = `
                <div class="max-w-7xl mx-auto px-6 flex flex-col md:flex-row border-4 border-black shadow-[-12px_12px_0_0_#000] bg-white" data-aos="fade-up">
                    <div class="p-12 md:w-1/2 border-b-4 md:border-b-0 md:border-r-4 border-black">
                        <h3 class="font-display text-5xl font-black mb-6 uppercase">About Us</h3>
                        <p class="text-xl font-bold border-l-8 border-brand pl-4">${copy.about}</p>
                    </div>
                    <div class="md:w-1/2 p-0 relative min-h-[300px]">
                        <img src="${getImage('about', 'team inside')}" alt="About" class="absolute inset-0 w-full h-full object-cover grayscale contrast-125"/>
                        <div class="absolute inset-0 bg-brand/30 mix-blend-multiply"></div>
                    </div>
                </div>`;
            } 
            else if (isBento) {
                heroContentHtml = `
                <div class="max-w-7xl mx-auto px-6 relative z-10 py-32" data-aos="fade-up">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="lg:col-span-2 ${radiusClass} ${cardClass} p-10 md:p-16 flex flex-col justify-center relative overflow-hidden bg-brand/5 border-none shadow-xl">
                            <div class="absolute -right-20 -top-20 w-64 h-64 bg-brand/20 blur-[80px] rounded-full"></div>
                            <div class="inline-flex w-max items-center gap-2 px-4 py-2 ${radiusClass} border border-brand/20 text-xs font-bold uppercase tracking-widest mb-8 bg-brand/10 text-brand">
                                <span class="w-2 h-2 rounded-full bg-brand animate-pulse"></span> Top Rated in ${data.city}
                            </div>
                            <h2 class="font-display text-5xl md:text-7xl font-black mb-6 tracking-tighter leading-[1.05] ${headClass} relative z-10">${copy.headline}</h2>
                            <p class="text-lg md:text-xl mb-10 font-medium leading-relaxed max-w-lg ${subClass} relative z-10">${copy.subhead}</p>
                            <div class="flex gap-4 relative z-10">
                                <a href="#contact" class="bg-brand text-white px-8 py-4 ${radiusClass} font-bold hover:opacity-90 transition-all">Get in Touch</a>
                            </div>
                        </div>
                        <div class="lg:col-span-1 ${radiusClass} overflow-hidden relative shadow-xl min-h-[300px]">
                            <img src="${getImage('hero')}" alt="Hero" class="absolute inset-0 w-full h-full object-cover hover:scale-105 transition duration-700"/>
                            <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent flex items-end p-8">
                                <a href="https://wa.me/91${cleanPhone}" class="w-full bg-white/20 backdrop-blur-md text-white border border-white/30 px-6 py-4 ${radiusClass} font-bold text-center hover:bg-white hover:text-black transition-all flex items-center justify-center gap-2"><i class="fa-brands fa-whatsapp text-lg"></i> Book Now</a>
                            </div>
                        </div>
                    </div>
                </div>`;

                aboutHtml = `
                <div class="max-w-7xl mx-auto px-6 grid lg:grid-cols-2 gap-6 items-stretch">
                    <div class="${radiusClass} ${cardClass} p-10 md:p-14 flex flex-col justify-center" data-aos="fade-right">
                        <div class="text-brand font-bold tracking-widest text-sm uppercase mb-4">About Us</div>
                        <h3 class="font-display text-4xl font-black mb-6 ${headClass}">The ${data.name} Standard.</h3>
                        <p class="text-lg leading-relaxed ${subClass}">${copy.about}</p>
                    </div>
                    <div class="grid grid-cols-2 gap-6" data-aos="fade-left">
                        <div class="${radiusClass} overflow-hidden relative shadow-md">
                            <img src="${getImage('about', 'team doing work')}" alt="About" class="absolute inset-0 w-full h-full object-cover"/>
                        </div>
                        <div class="${radiusClass} ${cardClass} p-8 flex flex-col items-center justify-center text-center bg-brand text-white border-none">
                            <h4 class="font-display text-5xl font-black mb-2">100%</h4>
                            <p class="text-sm font-bold uppercase tracking-widest opacity-80">Guaranteed</p>
                        </div>
                    </div>
                </div>`;
            } 
            else if (isCorporate || data.heroStyle === 'split') {
                heroContentHtml = `
                <div class="max-w-7xl mx-auto px-6 relative z-10 grid lg:grid-cols-2 gap-12 items-center min-h-[85vh] py-32">
                    <div class="text-left" data-aos="fade-right">
                        <div class="inline-flex items-center gap-2 px-4 py-1.5 ${radiusClass} border border-brand/20 text-xs font-bold uppercase tracking-widest mb-8 bg-brand/5 text-brand shadow-sm">
                            <span class="w-2 h-2 rounded-full bg-brand animate-pulse"></span> Serving ${data.city}
                        </div>
                        <h2 class="font-display text-5xl md:text-6xl lg:text-7xl font-black mb-6 tracking-tighter leading-[1.1] ${headClass}">${copy.headline}</h2>
                        <p class="text-lg md:text-xl mb-10 font-light leading-relaxed max-w-lg ${subClass}">${copy.subhead}</p>
                        <div class="flex flex-col sm:flex-row gap-4">
                            <a href="#services" class="bg-brand text-white px-8 py-4 ${radiusClass} font-bold text-center hover:opacity-90 transition-all shadow-lg">Explore Services</a>
                            <a href="#contact" class="px-8 py-4 ${radiusClass} text-center font-bold hover:bg-brand/5 transition-all flex items-center justify-center gap-2 border-2 border-brand/30 text-brand">Contact Us</a>
                        </div>
                    </div>
                    <div class="hidden lg:block" data-aos="fade-left" data-aos-delay="200">
                        <div class="w-full aspect-[4/3] ${radiusClass} overflow-hidden relative shadow-2xl group border border-white/10">
                            <img src="${getImage('hero')}" alt="${data.type}" class="absolute inset-0 w-full h-full object-cover group-hover:scale-105 transition duration-700 z-10"/>
                        </div>
                    </div>
                </div>`;

                aboutHtml = `
                <div class="max-w-7xl mx-auto px-6 grid lg:grid-cols-2 gap-16 lg:gap-24 items-center">
                    <div data-aos="fade-right">
                        <div class="text-brand font-bold tracking-widest text-sm uppercase mb-4">About Us</div>
                        <h3 class="font-display text-4xl md:text-5xl font-black mb-8 ${headClass} leading-tight">Why choose ${data.name}?</h3>
                        <p class="text-lg leading-relaxed font-light mb-8 ${subClass}">${copy.about}</p>
                        <div class="grid grid-cols-2 gap-6 mt-10 border-t ${isDark ? 'border-gray-800' : 'border-gray-200'} pt-10">
                            <div>
                                <h4 class="font-display text-3xl font-black text-brand mb-2">100%</h4>
                                <p class="text-sm font-medium ${subClass}">Client Satisfaction</p>
                            </div>
                            <div>
                                <h4 class="font-display text-3xl font-black text-brand mb-2">24/7</h4>
                                <p class="text-sm font-medium ${subClass}">Expert Support</p>
                            </div>
                        </div>
                    </div>
                    <div class="w-full aspect-square ${radiusClass} shadow-2xl flex items-center justify-center border-4 border-white/10 overflow-hidden relative" data-aos="fade-left">
                         <img src="${getImage('about', 'quality work')}" alt="About" class="absolute inset-0 w-full h-full object-cover z-0"/>
                         <div class="absolute inset-0 bg-black/40 z-0"></div>
                         <div class="relative z-10 text-center bg-black/60 backdrop-blur-md p-10 ${radiusClass} border border-white/20 shadow-2xl transform hover:scale-105 transition-transform duration-500">
                            <i class="fa-solid fa-shield-halved text-6xl text-brand mb-6 drop-shadow-lg"></i>
                            <h4 class="font-display font-black text-3xl text-white">Premium</h4>
                            <p class="text-gray-300 mt-2 text-sm font-bold tracking-widest uppercase">Guaranteed</p>
                        </div>
                    </div>
                </div>`;
            }
            else {
                heroContentHtml = `
                <div class="max-w-7xl mx-auto px-6 relative z-10 text-center py-32" data-aos="zoom-in" data-aos-duration="1000">
                    <div class="inline-flex items-center gap-2 px-5 py-2 ${radiusClass} border border-brand/20 text-sm font-semibold mb-8 bg-brand/5 text-brand shadow-sm">
                        <span class="w-2 h-2 rounded-full bg-brand animate-pulse"></span> Top Rated in ${data.city}
                    </div>
                    <h2 class="font-display text-5xl md:text-7xl lg:text-[6rem] font-black mb-8 tracking-tighter leading-[1.05] max-w-5xl mx-auto ${headClass} brand-glow">
                        ${copy.headline}
                    </h2>
                    <p class="text-lg md:text-2xl max-w-3xl mx-auto mb-12 font-light leading-relaxed ${subClass}">
                        ${copy.subhead}
                    </p>
                    <div class="flex flex-col sm:flex-row justify-center gap-4">
                        <a href="#services" class="bg-brand text-white px-10 py-4 ${radiusClass} font-bold text-lg shadow-xl hover:shadow-2xl hover:-translate-y-1 transition-all">Explore Services</a>
                        <a href="#contact" class="px-10 py-4 ${radiusClass} font-bold text-lg border-2 border-brand/30 text-brand hover:bg-brand/5 transition-all flex items-center justify-center gap-2">Contact Us</a>
                    </div>
                </div>`;

                aboutHtml = `
                <div class="max-w-7xl mx-auto px-6 grid lg:grid-cols-2 gap-16 lg:gap-24 items-center">
                    <div data-aos="fade-right">
                        <div class="text-brand font-bold tracking-widest text-sm uppercase mb-4">About Us</div>
                        <h3 class="font-display text-4xl md:text-5xl font-black mb-8 ${headClass} leading-tight">Why choose ${data.name}?</h3>
                        <p class="text-lg leading-relaxed font-light mb-8 ${subClass}">${copy.about}</p>
                        <div class="grid grid-cols-2 gap-6 mt-10 border-t ${isDark ? 'border-gray-800' : 'border-gray-200'} pt-10">
                            <div>
                                <h4 class="font-display text-3xl font-black text-brand mb-2">100%</h4>
                                <p class="text-sm font-medium ${subClass}">Client Satisfaction</p>
                            </div>
                            <div>
                                <h4 class="font-display text-3xl font-black text-brand mb-2">24/7</h4>
                                <p class="text-sm font-medium ${subClass}">Expert Support</p>
                            </div>
                        </div>
                    </div>
                    <div class="w-full aspect-square ${radiusClass} shadow-2xl flex items-center justify-center border-4 border-white/10 overflow-hidden relative" data-aos="fade-left">
                         <img src="${getImage('about', 'professional team')}" alt="About" class="absolute inset-0 w-full h-full object-cover z-0"/>
                         <div class="absolute inset-0 bg-black/40 z-0"></div>
                         <div class="relative z-10 text-center bg-black/60 backdrop-blur-md p-10 ${radiusClass} border border-white/20 shadow-2xl transform hover:scale-105 transition-transform duration-500">
                            <i class="fa-solid fa-shield-halved text-6xl text-brand mb-6 drop-shadow-lg"></i>
                            <h4 class="font-display font-black text-3xl text-white">Premium</h4>
                            <p class="text-gray-300 mt-2 text-sm font-bold tracking-widest uppercase">Guaranteed</p>
                        </div>
                    </div>
                </div>`;
            }

            // Universal Services Builder
            servicesHtml = `
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                ${finalServices.slice(0, 4).map((service, idx) => `
                <div class="p-8 ${radiusClass} ${cardClass} group" data-aos="fade-up" data-aos-delay="${idx*100}">
                    <div class="w-14 h-14 bg-brand/10 rounded-xl flex items-center justify-center text-2xl mb-8 text-brand group-hover:scale-110 group-hover:bg-brand group-hover:text-white transition-all duration-300 shadow-sm"><i class="fa-solid fa-check"></i></div>
                    <h4 class="font-display text-2xl font-bold mb-4 ${headClass}">${service}</h4>
                    <p class="font-light text-base leading-relaxed ${subClass}">Expert implementation tailored to your specific requirements and goals.</p>
                </div>`).join('')}
            </div>`;

            const galleryContent = data.showGallery ? `
            <section id="gallery" class="py-32 ${sectionBg2} border-y ${isDark ? 'border-[#222]' : 'border-gray-100'} overflow-hidden">
                <div class="max-w-7xl mx-auto px-6">
                    <div class="text-center max-w-2xl mx-auto mb-16" data-aos="fade-up">
                        <div class="text-brand font-bold tracking-widest text-sm uppercase mb-4">Our Portfolio</div>
                        <h3 class="font-display text-4xl md:text-5xl font-black ${headClass}">Recent Work.</h3>
                    </div>
                    <div class="grid ${isBento ? 'grid-cols-2 md:grid-cols-4 gap-4' : 'grid-cols-2 md:grid-cols-3 gap-4 md:gap-6'}">
                        ${[1,2,3,4,5,6].map((i) => `
                        <div class="aspect-square ${radiusClass} overflow-hidden relative group shadow-md border ${isDark?'border-white/10':'border-black/5'} ${isBento && i===1 ? 'md:col-span-2 md:row-span-2' : ''}" data-aos="fade-up" data-aos-delay="${(i%3)*100}">
                            <img src="${getImage('gallery'+i, 'work project detailed')}" alt="Gallery ${i}" class="absolute inset-0 w-full h-full object-cover group-hover:scale-110 transition duration-700 z-10"/>
                            <div class="absolute inset-0 bg-brand/80 opacity-0 group-hover:opacity-100 transition duration-300 z-20 flex items-center justify-center pointer-events-none">
                                <i class="fa-solid fa-magnifying-glass-plus text-white text-3xl transform scale-50 group-hover:scale-100 transition duration-300"></i>
                            </div>
                        </div>`).join('')}
                    </div>
                </div>
            </section>` : '';

            const testimonialsContent = data.showTestimonials ? `
            <section id="testimonials" class="py-32 ${sectionBg1}">
                <div class="max-w-7xl mx-auto px-6">
                    <div class="text-center max-w-2xl mx-auto mb-20" data-aos="fade-up">
                        <div class="text-brand font-bold tracking-widest text-sm uppercase mb-4">Client Feedback</div>
                        <h3 class="font-display text-4xl md:text-5xl font-black ${headClass}">Don't just take our word for it.</h3>
                    </div>
                    <div class="grid md:grid-cols-3 gap-8">
                        ${copy.testimonials.map((test, i) => `
                        <div class="p-8 ${radiusClass} ${cardClass} relative" data-aos="fade-up" data-aos-delay="${i*100}">
                            <i class="fa-solid fa-quote-right absolute top-8 right-8 text-6xl text-brand opacity-10"></i>
                            <div class="flex gap-1 text-brand mb-6 text-sm">
                                ${Array(test.rating).fill('<i class="fa-solid fa-star"></i>').join('')}
                            </div>
                            <p class="font-light text-lg leading-relaxed ${subClass} mb-8">"${test.text}"</p>
                            <div class="flex items-center gap-4 border-t ${isDark?'border-white/10':'border-gray-200'} pt-6">
                                <img src="https://api.dicebear.com/7.x/initials/svg?seed=${encodeURIComponent(test.name)}&backgroundColor=${mainColor.replace('#','')}" alt="Avatar" class="w-10 h-10 rounded-full border border-white/10"/>
                                <div>
                                    <h4 class="font-bold ${headClass} text-sm">${test.name}</h4>
                                    <p class="text-xs ${subClass}">Verified Client</p>
                                </div>
                            </div>
                        </div>`).join('')}
                    </div>
                </div>
            </section>` : '';

            const faqHtml = data.showFAQ ? `
            <section id="faq" class="py-32 ${sectionBg2} border-y ${isDark ? 'border-[#222]' : 'border-gray-100'}">
                <div class="max-w-4xl mx-auto px-6">
                    <div class="text-center mb-16" data-aos="fade-up">
                        <div class="text-brand font-bold tracking-widest text-sm uppercase mb-4">FAQ</div>
                        <h3 class="font-display text-4xl md:text-5xl font-black ${headClass}">Common Questions.</h3>
                    </div>
                    <div class="space-y-6">
                        ${copy.faqs.map((faq, i) => `
                        <div class="p-6 md:p-8 ${radiusClass} ${cardClass}" data-aos="fade-up" data-aos-delay="${i*100}">
                            <h4 class="font-display font-bold text-xl mb-3 ${headClass} flex items-start gap-4"><i class="fa-solid fa-circle-question text-brand mt-1"></i> ${faq.q}</h4>
                            <p class="font-light text-base leading-relaxed ${subClass} pl-9">${faq.a}</p>
                        </div>`).join('')}
                    </div>
                </div>
            </section>` : '';

            let pricingSectionHtml = '';
            if (data.hasPricing === 'yes') {
                pricingSectionHtml = `
                <section id="pricing" class="py-32 ${sectionBg1}">
                    <div class="max-w-7xl mx-auto px-6">
                        <div class="text-center max-w-2xl mx-auto mb-20" data-aos="fade-up">
                            <div class="text-brand font-bold tracking-widest text-sm uppercase mb-4">Pricing</div>
                            <h3 class="font-display text-4xl md:text-5xl font-black tracking-tight mb-8 ${headClass}">Transparent plans.</h3>
                            <div class="inline-block bg-brand/10 border border-brand/20 px-8 py-4 rounded-2xl mb-8 shadow-sm">
                                <p class="text-xl md:text-2xl font-black text-brand">${data.pricingDetails}</p>
                            </div>
                            <p class="text-lg font-light ${subClass}">Choose the tier that fits your needs.</p>
                        </div>
                        <div class="grid lg:grid-cols-3 gap-8 items-center max-w-5xl mx-auto">
                            ${copy.pricing.map((p, i) => `
                            <div class="p-10 ${radiusClass} ${cardClass} flex flex-col relative ${i===1 && !isBrutalist ? `border-2 border-brand shadow-[0_20px_50px_rgba(79,70,229,0.15)] transform lg:-translate-y-8 bg-white dark:bg-[#111] z-10 py-14` : ''}" data-aos="fade-up" data-aos-delay="${i*100}">
                                ${i===1 && !isBrutalist ? `<div class="absolute -top-5 left-1/2 transform -translate-x-1/2 bg-gradient-to-r from-brand to-brand-dark text-white text-xs font-black px-6 py-2 rounded-full uppercase tracking-widest shadow-xl">Most Popular</div>` : ''}
                                <h4 class="font-display text-3xl font-black mb-3 ${headClass}">${p.name}</h4>
                                <p class="text-base ${subClass} mb-8 h-12">${p.desc}</p>
                                <div class="text-5xl font-display font-black mb-10 ${headClass}">${p.price}</div>
                                <ul class="space-y-5 text-base ${subClass} font-medium mb-12 flex-1">
                                    <li class="flex items-center gap-4"><i class="fa-solid fa-circle-check text-brand text-lg"></i> ${p.f1}</li>
                                    <li class="flex items-center gap-4"><i class="fa-solid fa-circle-check text-brand text-lg"></i> ${p.f2}</li>
                                    <li class="flex items-center gap-4"><i class="fa-solid fa-circle-check text-brand text-lg"></i> ${p.f3}</li>
                                </ul>
                                <a href="https://wa.me/91${cleanPhone}?text=Hi, I want to book the ${p.name} plan from your website." target="_blank" class="w-full text-center py-4 ${isBrutalist||t==='minimal'?'rounded-none border-2 border-black':'rounded-xl'} font-bold text-lg transition-all ${i===1 ? 'bg-brand text-white hover:opacity-90 hover:shadow-lg' : (isDark?'bg-white/10 text-white hover:bg-white/20':'bg-gray-100 text-gray-900 hover:bg-gray-200')}">Select ${p.name}</a>
                            </div>
                            `).join('')}
                        </div>
                    </div>
                </section>`;
            }

            // 100x UPGRADE: ZERO-BACKEND WHATSAPP LEAD GEN + KEYLESS GOOGLE MAPS IFRAME
            const contactFormHtml = `
            <section id="contact" class="py-32 ${sectionBg2} border-t ${isDark ? 'border-[#222]' : 'border-gray-100'}">
                <div class="max-w-7xl mx-auto px-6">
                    <div class="text-center mb-16" data-aos="fade-up">
                        <div class="text-brand font-bold tracking-widest text-sm uppercase mb-4">Get in Touch</div>
                        <h3 class="font-display text-4xl md:text-5xl font-black ${headClass}">Send us a message.</h3>
                    </div>
                    
                    <div class="grid lg:grid-cols-2 gap-12 items-start">
                        <div class="w-full h-[500px] ${radiusClass} overflow-hidden shadow-xl border ${isDark?'border-white/5':'border-gray-200'} relative" data-aos="fade-right">
                            <div class="absolute inset-0 bg-brand/10 pointer-events-none z-10 mix-blend-color"></div>
                            <iframe width="100%" height="100%" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://maps.google.com/maps?q=${encodedAddress}&t=&z=13&ie=UTF8&iwloc=&output=embed" style="filter: ${isDark ? 'invert(90%) hue-rotate(180deg)' : 'none'};"></iframe>
                        </div>

                        <form id="wa-form" class="space-y-6 ${cardClass} p-8 md:p-12 ${radiusClass}" data-aos="fade-left" data-aos-delay="100">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-xs font-bold ${subClass} mb-2 uppercase tracking-widest">Full Name</label>
                                    <input type="text" id="wa-name" class="w-full bg-transparent border border-[var(--tw-shadow-color)] ${isDark?'border-gray-700':'border-gray-300'} rounded-xl px-4 py-3 focus:outline-none focus:border-brand-500 text-current" required>
                                </div>
                                <div>
                                    <label class="block text-xs font-bold ${subClass} mb-2 uppercase tracking-widest">Email Address</label>
                                    <input type="email" id="wa-email" class="w-full bg-transparent border border-[var(--tw-shadow-color)] ${isDark?'border-gray-700':'border-gray-300'} rounded-xl px-4 py-3 focus:outline-none focus:border-brand-500 text-current" required>
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs font-bold ${subClass} mb-2 uppercase tracking-widest">Message</label>
                                <textarea id="wa-msg" rows="4" class="w-full bg-transparent border border-[var(--tw-shadow-color)] ${isDark?'border-gray-700':'border-gray-300'} rounded-xl px-4 py-3 focus:outline-none focus:border-brand-500 text-current resize-none" required></textarea>
                            </div>
                            <button type="button" onclick="submitWA()" class="w-full bg-brand text-white font-bold tracking-widest uppercase py-4 rounded-xl hover:opacity-90 transition shadow-lg">Send via WhatsApp</button>
                            <p class="text-[10px] text-center ${subClass} mt-4"><i class="fa-solid fa-bolt mr-1"></i> Instant delivery to business owner.</p>
                        </form>
                    </div>
                </div>
            </section>
            <script>
                function submitWA() {
                    const n = document.getElementById('wa-name').value;
                    const e = document.getElementById('wa-email').value;
                    const m = document.getElementById('wa-msg').value;
                    if(!n || !m) { alert('Please enter your name and message.'); return; }
                    const txt = 'New Website Lead!%0A%0A*Name:* ' + encodeURIComponent(n) + '%0A*Email:* ' + encodeURIComponent(e) + '%0A%0A*Message:* ' + encodeURIComponent(m);
                    window.open('https://wa.me/91${cleanPhone}?text=' + txt, '_blank');
                }
            <\/script>`;

            return `<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${data.name} | ${data.city}</title>
    <meta name="description" content="${copy.about}">
    ${seoTags}
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=${fontImport}&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <script src="https://cdn.tailwindcss.com"><\/script>
    <script>
        tailwind.config = { theme: { extend: { fontFamily: { sans: ['Inter', 'sans-serif'], display: ['${fontName}', 'sans-serif'] }, colors: { brand: { DEFAULT: '${mainColor}', light: '${mainColor}15', dark: '${mainColor}cc' } } } } }
    <\/script>
    <style>
        ${customCSS}
        .glass-nav { backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); }
        .mobile-menu-open { transform: translateX(0%); } .mobile-menu-closed { transform: translateX(100%); }
        body.is-editing [data-aos] { opacity: 1 !important; transform: none !important; transition: none !important; }
    </style>
</head>
<body class="font-sans antialiased selection:bg-brand selection:text-white ${bodyClass} pb-0">
    ${watermarkHtml}
    ${whatsappWidgetHtml}

    <nav class="glass-nav fixed w-full top-0 z-50 transition-all duration-300 ${navClass}">
        <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center relative z-50">
            <h1 class="font-display font-black text-2xl tracking-tighter flex items-center gap-2">
                <span class="w-8 h-8 bg-brand text-white flex justify-center items-center ${isBrutalist||t==='minimal'?'rounded-none':'rounded-lg'} text-sm shadow-md"><i class="fa-solid ${icon}"></i></span>
                ${data.name}
            </h1>
            <div class="hidden md:flex gap-8 items-center font-semibold text-sm opacity-80 uppercase tracking-widest">
                ${navLinksHtml}
            </div>
            <div class="hidden md:block">
                <a href="https://wa.me/91${cleanPhone}" target="_blank" class="bg-brand text-white px-6 py-2.5 ${isBrutalist||t==='minimal'?'rounded-none border-2 border-black':'rounded-full'} font-bold text-sm shadow-lg hover:opacity-90 transition transform hover:-translate-y-0.5 inline-block">WhatsApp Us</a>
            </div>
            <button id="mobile-menu-btn" class="md:hidden text-2xl p-2 focus:outline-none"><i class="fa-solid fa-bars"></i></button>
        </div>

        <div id="mobile-menu" class="fixed inset-0 ${isDark ? 'bg-[#0a0a0a]' : 'bg-white'} z-40 flex flex-col pt-24 px-6 pb-8 transition-transform duration-500 mobile-menu-closed md:hidden">
            <div class="flex flex-col gap-6 text-3xl font-display font-black ${headClass}">
                ${mobileNavLinksHtml}
            </div>
            <div class="mt-auto flex flex-col gap-4">
                <a href="#contact" class="w-full bg-black/10 dark:bg-white/10 text-current text-center py-4 ${radiusClass} font-bold text-lg mobile-link">
                    Contact Us
                </a>
                <a href="https://wa.me/91${cleanPhone}" target="_blank" class="w-full bg-brand text-white text-center py-4 ${radiusClass} font-bold text-lg flex items-center justify-center gap-2 shadow-xl">
                    <i class="fa-brands fa-whatsapp"></i> Chat on WhatsApp
                </a>
            </div>
        </div>
    </nav>

    <header class="relative pt-24 md:pt-16 overflow-hidden hero-bg ${sectionBg1} flex flex-col justify-center min-h-[90vh]">
        ${heroContentHtml}
    </header>

    <section id="about" class="py-32 ${sectionBg2} border-y ${isDark ? 'border-[#222]' : 'border-gray-100'} overflow-hidden">
        ${aboutHtml}
    </section>

    <section id="services" class="py-32 ${sectionBg1} overflow-hidden">
        <div class="max-w-7xl mx-auto px-6">
            <div class="text-center max-w-2xl mx-auto mb-20" data-aos="fade-up">
                <div class="text-brand font-bold tracking-widest text-sm uppercase mb-4">Our Services</div>
                <h3 class="font-display text-4xl md:text-5xl font-black ${headClass}">Expertise you can trust.</h3>
            </div>
            ${servicesHtml}
        </div>
    </section>

    ${galleryContent}
    ${testimonialsContent}
    ${pricingSectionHtml}
    ${faqHtml}
    ${contactFormHtml}

    <footer class="bg-[#050505] text-gray-400 py-20 border-t border-[#222]">
        <div class="max-w-7xl mx-auto px-6 grid md:grid-cols-3 gap-12 text-center md:text-left items-center md:items-start">
            <div>
                <div class="font-display font-black text-white text-3xl flex items-center justify-center md:justify-start gap-3 mb-6"><span class="w-10 h-10 bg-brand text-white flex justify-center items-center rounded-lg text-lg"><i class="fa-solid ${icon}"></i></span>${data.name}</div>
                <p class="text-sm text-gray-500 leading-relaxed max-w-xs mx-auto md:mx-0">${copy.about.substring(0, 100)}...</p>
            </div>
            <div class="flex flex-col space-y-4 font-medium text-sm uppercase tracking-widest">
                <h4 class="text-white font-bold mb-2">Links</h4>
                ${navLinksHtml}
            </div>
            <div class="flex flex-col md:items-end space-y-4 text-sm text-gray-500">
                <h4 class="text-white font-bold uppercase tracking-widest mb-2 text-center md:text-right">Contact</h4>
                <p class="flex items-center justify-center md:justify-end gap-3 text-right"><i class="fa-solid fa-location-dot mt-1 flex-shrink-0"></i> <span>${data.hasAddress === 'yes' && data.address ? data.address : data.city}</span></p>
                <p class="flex items-center justify-center md:justify-end gap-3"><i class="fa-solid fa-phone"></i> +91 ${data.phone}</p>
                <a href="https://wa.me/91${cleanPhone}" target="_blank" class="bg-brand text-white px-8 py-3 ${radiusClass} font-bold mt-4 shadow-lg hover:opacity-90 transition inline-block text-center"><i class="fa-brands fa-whatsapp mr-2"></i> Message Us</a>
            </div>
        </div>
        <div class="max-w-7xl mx-auto px-6 mt-16 pt-8 border-t border-white/10 text-center text-xs text-gray-600 tracking-widest uppercase">
            © ${new Date().getFullYear()} ${data.name}. All rights reserved.
        </div>
    </footer>

    <script src="https://unpkg.com/aos@next/dist/aos.js"><\/script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            AOS.init({ duration: 800, once: true, offset: 50 });

            const menuBtn = document.getElementById('mobile-menu-btn');
            const menu = document.getElementById('mobile-menu');
            const icon = menuBtn.querySelector('i');
            const links = document.querySelectorAll('.mobile-link');
            
            menuBtn.addEventListener('click', () => {
                const isOpen = !menu.classList.contains('mobile-menu-closed');
                if(isOpen) {
                    menu.classList.add('mobile-menu-closed'); menu.classList.remove('mobile-menu-open'); icon.classList.replace('fa-xmark', 'fa-bars');
                } else {
                    menu.classList.remove('mobile-menu-closed'); menu.classList.add('mobile-menu-open'); icon.classList.replace('fa-bars', 'fa-xmark');
                }
            });
            links.forEach(link => {
                link.addEventListener('click', () => { menu.classList.add('mobile-menu-closed'); menu.classList.remove('mobile-menu-open'); icon.classList.replace('fa-xmark', 'fa-bars'); });
            });
        });
    <\/script>
    <script id="dbp-live-editor">
        let isEditMode = true;
        let activeImage = null;
        
        function applyEditMode() {
            document.body.classList.toggle('is-editing', isEditMode);
            const editableElements = document.querySelectorAll('h1, h2, h3, h4, p, span, li, div.font-display');
            editableElements.forEach(el => {
                if (el.closest('nav') || el.closest('button') || el.closest('a') || el.classList.contains('fa-solid') || el.closest('form')) return;
                if (isEditMode) {
                    el.setAttribute('contenteditable', 'true');
                    el.style.outline = 'none';
                    el.style.cursor = 'text';
                } else {
                    el.removeAttribute('contenteditable');
                    el.style.cursor = 'default';
                    el.style.boxShadow = 'none';
                }
            });
        }

        document.addEventListener('click', (e) => {
            if(isEditMode && e.target.tagName === 'IMG') {
                e.preventDefault();
                activeImage = e.target;
                window.parent.postMessage({ type: 'REQUEST_IMAGE_UPLOAD' }, '*');
            }
        });

        document.addEventListener('input', (e) => {
            if(e.target.hasAttribute('contenteditable')) {
                const cleanDoc = document.documentElement.cloneNode(true);
                window.parent.postMessage({ type: 'LIVE_EDIT_UPDATE', html: cleanDoc.outerHTML }, '*');
            }
        });

        document.addEventListener('mouseover', (e) => {
            if(!isEditMode) return;
            if((e.target.hasAttribute('contenteditable') && document.activeElement !== e.target)) {
                e.target.style.boxShadow = '0 0 0 2px rgba(168, 85, 247, 0.5)';
            } else if (e.target.tagName === 'IMG') {
                e.target.style.outline = '4px dashed #a855f7';
                e.target.style.cursor = 'pointer';
            }
        }, true);
        
        document.addEventListener('mouseout', (e) => {
            if(!isEditMode) return;
            if((e.target.hasAttribute('contenteditable') && document.activeElement !== e.target)) {
                e.target.style.boxShadow = 'none';
            } else if (e.target.tagName === 'IMG') {
                e.target.style.outline = 'none';
            }
        }, true);

        document.addEventListener('focus', (e) => {
            if(isEditMode && e.target.hasAttribute('contenteditable')) {
                e.target.style.boxShadow = '0 0 0 2px rgba(168, 85, 247, 0.9)';
            }
        }, true);

        document.addEventListener('blur', (e) => {
            if(isEditMode && e.target.hasAttribute('contenteditable')) {
                e.target.style.boxShadow = 'none';
            }
        }, true);

        window.addEventListener('message', (event) => {
            if (event.data && event.data.type === 'TOGGLE_EDIT_MODE') {
                isEditMode = event.data.value;
                applyEditMode();
                document.querySelectorAll('img').forEach(img => img.style.outline = 'none');
            }
            if (event.data && event.data.type === 'UPDATE_IMAGE_SRC' && activeImage) {
                activeImage.src = event.data.url;
                const cleanDoc = document.documentElement.cloneNode(true);
                window.parent.postMessage({ type: 'LIVE_EDIT_UPDATE', html: cleanDoc.outerHTML }, '*');
                activeImage = null;
            }
        });

        applyEditMode();
    <\/script>
    <script id="dbp-preview-helper">
        document.addEventListener('click', function(e) {
            const link = e.target.closest('a');
            if (!link) return;
            const href = link.getAttribute('href');
            if (href && href.startsWith('#')) {
                e.preventDefault();
                const targetId = href.substring(1);
                const targetElement = document.getElementById(targetId);
                if (targetElement) {
                    targetElement.scrollIntoView({ behavior: 'smooth' });
                    document.getElementById('mobile-menu').classList.add('mobile-menu-closed');
                    document.getElementById('mobile-menu').classList.remove('mobile-menu-open');
                    const icon = document.querySelector('#mobile-menu-btn i');
                    if(icon) icon.classList.replace('fa-xmark', 'fa-bars');
                }
            } else if (href && !href.startsWith('#') && !link.closest('form')) {
                e.preventDefault();
                alert("Link navigation is disabled inside the Live Preview to prevent losing unsaved edits.");
            }
        });
    <\/script>
</body>
</html>`;
        };

        const App = () => {
            const [view, setView] = useState('home'); 
            const [isBuilderRevealed, setIsBuilderRevealed] = useState(false);
            const [isProcessing, setIsProcessing] = useState(false);
            const [processMsg, setProcessMsg] = useState("PROCESSING");
            const [showTrialPrompt, setShowTrialPrompt] = useState(false);
            
            const [siteCode, setSiteCode] = useState('');
            const siteCodeRef = useRef(''); 
            
            const [previewMode, setPreviewMode] = useState('desktop');
            const [isEditMode, setIsEditMode] = useState(true);
            const iframeRef = useRef(null);

            const [toast, setToast] = useState(null);
            const [loadingLogs, setLoadingLogs] = useState([]);
            const [loadingProgress, setLoadingProgress] = useState(0);
            
            const [users, setUsers] = useState([]);
            const [requests, setRequests] = useState([]);
            const [currentUser, setCurrentUser] = useState(null);
            const [userSites, setUserSites] = useState([]);
            const [currentTime, setCurrentTime] = useState(new Date());
            
            useEffect(() => {
                const timer = setInterval(() => setCurrentTime(new Date()), 60000);
                return () => clearInterval(timer);
            }, []);

            const isAdmin = currentUser && currentUser.phone === '9827700975'; 
            
            const isPermanentlyPro = currentUser && currentUser.isPro;
            const isTrialActive = currentUser && currentUser.trialEndsAt && new Date(currentUser.trialEndsAt) > currentTime;
            const isPro = isPermanentlyPro || isTrialActive;
            const canRedeemTrial = currentUser && !currentUser.trialRedeemed && !isPermanentlyPro;

            const getTrialTimeLeft = () => {
                if (!currentUser || !currentUser.trialEndsAt) return null;
                const diff = new Date(currentUser.trialEndsAt) - currentTime;
                if (diff <= 0) return "Expired";
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
                const mins = Math.floor((diff / 1000 / 60) % 60);
                return `${days}d ${hours}h ${mins}m`;
            };

            const [authMode, setAuthMode] = useState('signup');
            const [authForm, setAuthForm] = useState({ name: '', phone: '', password: '' });

            const presetColors = ['#a855f7', '#10b981', '#f59e0b', '#171717']; 
            const proColors = ['#e11d48', '#d946ef', '#0ea5e9', '#84cc16']; 

            const [form, setForm] = useState({
                name: '', type: '', city: '', phone: '', address: '', hasAddress: 'no', hasPricing: 'no', pricingDetails: '', description: '', services: '', seo: '', color: '#a855f7', 
                template: 'ai-dark',
                heroStyle: 'center', showTestimonials: true, showFAQ: true, showGallery: true
            });

            useEffect(() => {
                const unsubscribeUsers = db.collection('users').onSnapshot(snapshot => {
                    const usersData = snapshot.docs.map(doc => doc.data());
                    setUsers(usersData);
                    
                    const storedUser = localStorage.getItem('dbp-current-user');
                    if (storedUser) {
                        const parsedUser = JSON.parse(storedUser);
                        const updatedUser = usersData.find(u => u.phone === parsedUser.phone);
                        if (updatedUser) {
                            setCurrentUser(updatedUser);
                            localStorage.setItem('dbp-current-user', JSON.stringify(updatedUser));
                        }
                    }
                });

                const unsubscribeRequests = db.collection('requests').onSnapshot(snapshot => {
                    setRequests(snapshot.docs.map(doc => ({ firebaseId: doc.id, ...doc.data() })));
                });

                const storedUser = localStorage.getItem('dbp-current-user');
                if (storedUser) {
                    const u = JSON.parse(storedUser);
                    setCurrentUser(u);
                    setForm(prev => ({...prev, name: u.name, phone: u.phone}));
                }

                return () => { unsubscribeUsers(); unsubscribeRequests(); };
            }, []);

            useEffect(() => {
                if (currentUser) {
                    const unsubscribeSites = db.collection('sites')
                        .where('phone', '==', currentUser.phone)
                        .onSnapshot(snap => {
                            const sites = snap.docs.map(doc => ({ firebaseId: doc.id, ...doc.data() }));
                            setUserSites(sites.reverse());
                        });
                    return () => unsubscribeSites();
                }
            }, [currentUser]);

            // LOCAL AI IMAGE COMPRESSOR + BASE64 (Zero Backend Required)
            useEffect(() => {
                const handleIframeMessage = async (event) => {
                    if (event.data && event.data.type === 'LIVE_EDIT_UPDATE') {
                        siteCodeRef.current = event.data.html;
                    }
                    if (event.data && event.data.type === 'REQUEST_IMAGE_UPLOAD') {
                        const input = document.createElement('input');
                        input.type = 'file';
                        input.accept = 'image/*';
                        input.onchange = (e) => {
                            const file = e.target.files[0];
                            if(!file) return;
                            setProcessMsg("OPTIMIZING ASSET...");
                            setIsProcessing(true);
                            
                            const reader = new FileReader();
                            reader.onload = (readerEvent) => {
                                const img = new Image();
                                img.onload = () => {
                                    const canvas = document.createElement('canvas');
                                    const MAX_WIDTH = 1200;
                                    const MAX_HEIGHT = 800;
                                    let width = img.width;
                                    let height = img.height;

                                    if (width > height) {
                                        if (width > MAX_WIDTH) {
                                            height *= MAX_WIDTH / width;
                                            width = MAX_WIDTH;
                                        }
                                    } else {
                                        if (height > MAX_HEIGHT) {
                                            width *= MAX_HEIGHT / height;
                                            height = MAX_HEIGHT;
                                        }
                                    }
                                    canvas.width = width;
                                    canvas.height = height;
                                    const ctx = canvas.getContext('2d');
                                    ctx.drawImage(img, 0, 0, width, height);
                                    
                                    const dataUrl = canvas.toDataURL('image/jpeg', 0.8);
                                    
                                    if (iframeRef.current && iframeRef.current.contentWindow) {
                                        iframeRef.current.contentWindow.postMessage({ type: 'UPDATE_IMAGE_SRC', url: dataUrl }, '*');
                                    }
                                    showToast("Asset optimized and applied!", "success");
                                    setIsProcessing(false);
                                    setProcessMsg("PROCESSING");
                                };
                                img.src = readerEvent.target.result;
                            };
                            reader.onerror = () => {
                                showToast("Failed to read file.", "error");
                                setIsProcessing(false);
                            };
                            reader.readAsDataURL(file);
                        };
                        input.click();
                    }
                };
                window.addEventListener('message', handleIframeMessage);
                return () => window.removeEventListener('message', handleIframeMessage);
            }, []);

            useEffect(() => {
                setTimeout(() => {
                    const splash = document.getElementById('dbp-splash');
                    if(splash) {
                        splash.style.opacity = '0';
                        setTimeout(() => splash.style.display = 'none', 800);
                    }
                }, 1500);
            }, []);

            const showToast = (msg, type='success') => { setToast({msg, type}); setTimeout(() => setToast(null), 3500); };

            const handleGetStarted = () => {
                setIsBuilderRevealed(true);
                setTimeout(() => {
                    const el = document.getElementById('builder-section');
                    if(el) el.scrollIntoView({ behavior: 'smooth' });
                }, 100);
            };

            const handleLogout = () => {
                if(window.confirm("Are you sure you want to securely log out of your session?")) {
                    setCurrentUser(null);
                    localStorage.removeItem('dbp-current-user');
                    setView('home');
                    window.scrollTo(0,0);
                }
            };
            
            const handleDeleteAccount = async () => {
                if(window.confirm("WARNING: Are you absolutely sure you want to delete your account? This action is irreversible and all your saved architectures will be permanently erased.")) {
                    setProcessMsg("DELETING IDENTITY...");
                    setIsProcessing(true);
                    try {
                        const sitesSnapshot = await db.collection('sites').where('phone', '==', currentUser.phone).get();
                        const batch = db.batch();
                        sitesSnapshot.docs.forEach(doc => { batch.delete(doc.ref); });
                        await batch.commit();

                        await db.collection('users').doc(currentUser.phone).delete();

                        setCurrentUser(null);
                        localStorage.removeItem('dbp-current-user');
                        setView('home');
                        window.scrollTo(0,0);
                        showToast("Account securely deleted.", "info");
                    } catch (err) {
                        showToast("Error deleting account. Check connection.", "error");
                    } finally {
                        setIsProcessing(false);
                        setProcessMsg("PROCESSING");
                    }
                }
            };

            const handleRedeemTrial = async () => {
                if(!currentUser || currentUser.trialRedeemed) return;
                setProcessMsg("ACTIVATING TRIAL...");
                setIsProcessing(true);
                try {
                    const trialEndDate = new Date();
                    trialEndDate.setDate(trialEndDate.getDate() + 7);
                    
                    await db.collection('users').doc(currentUser.phone).update({
                        trialRedeemed: true,
                        trialEndsAt: trialEndDate.toISOString()
                    });
                    
                    showToast("1-Week PRO Trial Activated! Enjoy the full experience.", "success");
                    setShowTrialPrompt(false);
                } catch (err) {
                    showToast("Error activating free trial.", "error");
                } finally {
                    setIsProcessing(false);
                    setProcessMsg("PROCESSING");
                }
            };

            const toggleEditMode = (mode) => {
                setIsEditMode(mode);
                if (iframeRef.current && iframeRef.current.contentWindow) {
                    iframeRef.current.contentWindow.postMessage({ type: 'TOGGLE_EDIT_MODE', value: mode }, '*');
                }
            };

            const handleAuth = async () => {
                if (authMode === 'signup') {
                    if (!authForm.name || !authForm.phone || !authForm.password) return showToast("All fields required", "error");
                    setProcessMsg("AUTHENTICATING...");
                    setIsProcessing(true);
                    try {
                        const docRef = db.collection('users').doc(authForm.phone);
                        const docSnap = await docRef.get();
                        if (docSnap.exists) { showToast("Phone already registered!", "error"); return; }

                        const newUser = { name: authForm.name, phone: authForm.phone, password: authForm.password, isPro: false, trialRedeemed: false, joined: new Date().toLocaleDateString() };
                        await docRef.set(newUser);
                        setCurrentUser(newUser);
                        localStorage.setItem('dbp-current-user', JSON.stringify(newUser));
                        setForm(prev => ({...prev, name: newUser.name, phone: newUser.phone}));
                        
                        setView('home'); setIsBuilderRevealed(false); window.scrollTo(0,0);
                        setShowTrialPrompt(true);
                    } catch (err) { showToast("Database Error: Check Firebase Rules", "error"); } finally { setIsProcessing(false); setProcessMsg("PROCESSING"); }
                } else {
                    if (!authForm.phone || !authForm.password) return showToast("Credentials required", "error");
                    setProcessMsg("AUTHENTICATING...");
                    setIsProcessing(true);
                    try {
                        const docRef = db.collection('users').doc(authForm.phone);
                        const docSnap = await docRef.get();
                        
                        if (docSnap.exists && docSnap.data().password === authForm.password) {
                            const user = docSnap.data();
                            setCurrentUser(user);
                            localStorage.setItem('dbp-current-user', JSON.stringify(user));
                            setForm(prev => ({...prev, name: user.name, phone: user.phone}));
                            
                            setView('home'); setIsBuilderRevealed(false); window.scrollTo(0,0);
                            
                            if (!user.isPro && !user.trialRedeemed) {
                                setShowTrialPrompt(true);
                            } else {
                                const trialActive = user.trialEndsAt && new Date(user.trialEndsAt) > new Date();
                                if (!user.isPro && trialActive) showToast(`Welcome back, ${user.name}! Your free PRO trial is active.`, "success");
                                else showToast(`Welcome back, ${user.name}!`, "success");
                            }
                        } else { showToast("Invalid credentials.", "error"); }
                    } catch (err) { showToast("Database Error: Check Firebase Rules", "error"); } finally { setIsProcessing(false); setProcessMsg("PROCESSING"); }
                }
            };

            const handleTemplateSelect = (tmpl) => {
                if (!isPro && ['dark', 'corporate', 'creative', 'neon', 'midnight', 'matrix', 'glassmorphism', 'brutalism', 'ai-dark', 'ai-light'].includes(tmpl)) return showToast("Unlock PRO to use Premium Templates!", "error");
                setForm({...form, template: tmpl});
            };
            const handleColorSelect = (c) => {
                if (!isPro && !presetColors.includes(c)) return showToast("Unlock PRO for premium colors!", "error");
                setForm({...form, color: c});
            };

            const handleGenerate = async () => {
                if(!currentUser) {
                    showToast("Please authenticate to securely compile your site.", "info");
                    setView('auth'); window.scrollTo({top: 0, behavior: 'smooth'}); return;
                }

                if(!form.name || !form.type || !form.city || !form.phone) return showToast("Please fill all required details (marked with *).", "error");
                if(form.hasPricing === 'yes' && !form.pricingDetails) return showToast("Please provide pricing details, or select 'No' to skip.", "error");
                if(form.hasAddress === 'yes' && !form.address) return showToast("Please provide a detailed address, or select 'No' to skip.", "error");
                
                setView('generating'); setLoadingLogs([]); setLoadingProgress(0);
                window.scrollTo({top: 0, behavior: 'smooth'});
                
                const addLog = (log, progress) => {
                    setLoadingLogs(prev => [...prev, log]);
                    setLoadingProgress(progress);
                };

                addLog(`root@dbp-engine:~$ ./build --type="${form.type}" --hero="${form.heroStyle}"`, 5);
                await new Promise(r => setTimeout(r, 400));
                addLog(`[OK] Auth Verified: ${isPro ? 'PRO' : 'FREE'} Tier.`, 15);
                await new Promise(r => setTimeout(r, 400));
                
                addLog(`> initializing Anti-Repetition Smart Copy Engine...`, 35);
                await new Promise(r => setTimeout(r, 600));

                addLog(`> rendering completely unique DOM for architecture: ${form.template}`, 60);
                await new Promise(r => setTimeout(r, 400));
                
                addLog(`> injecting AOS animation architecture for fluid interactions...`, 75);
                await new Promise(r => setTimeout(r, 400));
                
                addLog(`> routing Free Keyless Google Maps framework...`, 85);
                await new Promise(r => setTimeout(r, 400));
                
                addLog(`> fetching high-res AI-generated images via Pollinations.ai...`, 95);
                await new Promise(r => setTimeout(r, 600));
                
                addLog(`[OK] Compile complete. Launching viewport.`, 100);
                
                const finalCode = generateSiteHTML(form, isPro);
                setSiteCode(finalCode);
                siteCodeRef.current = finalCode; 
                
                setTimeout(() => {
                    setView('preview');
                    setIsEditMode(true); 
                }, 800); 
            };

            const saveProjectToCloud = async () => {
                if(!currentUser) return showToast("You must be logged in to save.", "error");
                setProcessMsg("SAVING TO CLOUD...");
                setIsProcessing(true);
                try {
                    await db.collection('sites').add({
                        phone: currentUser.phone,
                        name: form.name || 'Untitled Site',
                        html: siteCodeRef.current,
                        date: new Date().toLocaleString()
                    });
                    showToast("Project saved to your Dashboard!", "success");
                } catch(err) { showToast("Failed to save project to cloud.", "error"); } finally { setIsProcessing(false); setProcessMsg("PROCESSING");}
            };

            const loadProject = (htmlCode, projectName) => {
                setSiteCode(htmlCode);
                siteCodeRef.current = htmlCode;
                setForm(prev => ({...prev, name: projectName}));
                setView('preview');
                setIsEditMode(true);
                showToast(`Loaded ${projectName}`, "success");
            };
            
            const deleteProject = async (docId) => {
                if(window.confirm("Are you sure you want to permanently delete this project?")) {
                    setProcessMsg("DELETING PROJECT...");
                    setIsProcessing(true);
                    try {
                        await db.collection('sites').doc(docId).delete();
                        showToast("Project deleted.", "info");
                    } catch(err) { showToast("Error deleting project.", "error"); } finally { setIsProcessing(false); setProcessMsg("PROCESSING"); }
                }
            };

            const launchLiveSite = (htmlCode) => {
                try {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(htmlCode, 'text/html');
                    const editorScript = doc.getElementById('dbp-live-editor');
                    if (editorScript) editorScript.remove();
                    const helperScript = doc.getElementById('dbp-preview-helper');
                    if (helperScript) helperScript.remove();

                    const editables = doc.querySelectorAll('[contenteditable]');
                    editables.forEach(el => {
                        el.removeAttribute('contenteditable'); el.style.outline = ''; el.style.cursor = ''; el.style.boxShadow = '';
                        if (el.getAttribute('style') === '') el.removeAttribute('style');
                    });

                    doc.body.classList.remove('is-editing');

                    const finalExportCode = '<!DOCTYPE html>\n' + doc.documentElement.outerHTML;
                    const blob = new Blob([finalExportCode], { type: 'text/html;charset=utf-8' });
                    const url = URL.createObjectURL(blob);
                    window.open(url, '_blank');
                } catch (e) {
                    showToast("Error launching live site.", "error");
                }
            };

            const downloadHTML = () => {
                try {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(siteCodeRef.current, 'text/html');
                    
                    const editorScript = doc.getElementById('dbp-live-editor');
                    if (editorScript) editorScript.remove();
                    const helperScript = doc.getElementById('dbp-preview-helper');
                    if (helperScript) helperScript.remove();

                    const editables = doc.querySelectorAll('[contenteditable]');
                    editables.forEach(el => {
                        el.removeAttribute('contenteditable'); el.style.outline = ''; el.style.cursor = ''; el.style.boxShadow = '';
                        if (el.getAttribute('style') === '') el.removeAttribute('style');
                    });

                    doc.body.classList.remove('is-editing');

                    const finalExportCode = '<!DOCTYPE html>\n' + doc.documentElement.outerHTML;
                    const blob = new Blob([finalExportCode], { type: 'text/html;charset=utf-8' });
                    const a = document.createElement('a');
                    a.href = URL.createObjectURL(blob);
                    a.download = `${form.name.replace(/\s+/g, '_').toLowerCase()}_site.html`;
                    a.click();
                    showToast("Clean code exported successfully!");
                } catch (e) { showToast("Error processing export.", "error"); }
            };

            const handlePaymentInit = () => {
                if(!currentUser) return setView('auth');
                if(isPermanentlyPro) return showToast("You already have an active permanent PRO subscription!", "info");
                
                const options = {
                    "key": "rzp_test_DBPInstantSiteKey", 
                    "amount": "49900", 
                    "currency": "INR",
                    "name": "DBP InstantSite AI",
                    "description": "Pro Editor Subscription",
                    "image": "https://cdn-icons-png.flaticon.com/512/3260/3260838.png",
                    "handler": async function (response) {
                        setProcessMsg("SECURING TRANSACTION...");
                        setIsProcessing(true);
                        try {
                            setToast({msg: "Processing payment...", type: "info"});
                            await db.collection('users').doc(currentUser.phone).update({ isPro: true });
                            showToast("Payment Successful! Permanent PRO features unlocked.", "success");
                            await db.collection('requests').add({ id: response.razorpay_payment_id, user: currentUser.name, phone: currentUser.phone, type: 'Razorpay Auto-Upgrade', status: 'Success', date: new Date().toLocaleDateString() });
                        } catch(err) { showToast("Database error post-payment. Contact admin.", "error"); } finally { setIsProcessing(false); setProcessMsg("PROCESSING");}
                    },
                    "prefill": { "name": currentUser.name, "contact": currentUser.phone },
                    "theme": { "color": "#8b5cf6" }
                };
                
                if (window.Razorpay) {
                    const rzp1 = new window.Razorpay(options); rzp1.open();
                } else { showToast("Payment gateway failed to load. Check connection.", "error"); }
            };

            const adminTogglePro = async (phone) => {
                setProcessMsg("UPDATING RECORD...");
                setIsProcessing(true);
                try {
                    const userRef = db.collection('users').doc(phone);
                    const userSnap = await userRef.get();
                    if(userSnap.exists) {
                        await userRef.update({ isPro: !userSnap.data().isPro });
                        showToast("User PRO status updated.", "success");
                    }
                } catch (err) { showToast("Error updating user.", "error"); } finally { setIsProcessing(false); setProcessMsg("PROCESSING"); }
            };
            
            const adminDeleteUser = async (phone) => {
                if(window.confirm("Are you sure you want to delete this user?")) {
                    setProcessMsg("DELETING RECORD...");
                    setIsProcessing(true);
                    try {
                        await db.collection('users').doc(phone).delete();
                        showToast("User deleted.", "info");
                    } catch (err) { showToast("Error deleting user.", "error"); } finally { setIsProcessing(false); setProcessMsg("PROCESSING");}
                }
            };

            const terminalEndRef = useRef(null);
            useEffect(() => { if(terminalEndRef.current) terminalEndRef.current.scrollIntoView({ behavior: 'smooth' }); }, [loadingLogs]);

            const MobileNav = () => (
                <header className="md:hidden glass-nav h-16 flex items-center justify-between px-6 sticky top-0 flex-shrink-0 z-[60]">
                    <div className="flex items-center gap-3 cursor-pointer" onClick={() => { setView('home'); window.scrollTo(0,0); }}>
                        <div className="w-8 h-8 bg-gradient-to-br from-brand-400 to-brand-600 rounded-lg flex items-center justify-center text-white font-display font-bold shadow-[0_0_10px_rgba(139,92,246,0.3)]">D</div>
                        <span className="font-display font-bold text-lg text-white">DBP<span className="text-brand-400 font-medium">SYSTEMS</span></span>
                    </div>
                    <div className="flex gap-4 items-center">
                        {currentUser ? (
                            <button onClick={() => setView('profile')} className="text-gray-400 hover:text-white flex items-center gap-2">
                                <i className="fa-solid fa-user"></i>
                            </button>
                        ) : (
                            <button onClick={() => setView('auth')} className="text-brand-400 font-bold text-xs">LOGIN</button>
                        )}
                    </div>
                </header>
            );

            const GlassSidebar = () => (
                <aside className="hidden md:flex flex-col items-center py-6 w-24 fixed left-4 top-4 bottom-4 glass-sidebar z-[100]">
                    <div className="w-12 h-12 bg-gradient-to-br from-brand-400 to-brand-600 rounded-xl flex items-center justify-center text-white font-display font-bold text-2xl shadow-[0_0_15px_rgba(139,92,246,0.4)] cursor-pointer hover:scale-105 transition transform mb-8" onClick={() => { setView('home'); window.scrollTo(0,0); }}>
                        D
                    </div>
                    
                    <div className="flex flex-col gap-5 w-full px-4">
                        <button onClick={() => { setView('home'); window.scrollTo(0,0); }} className={`nav-item ${view === 'home' ? 'active' : ''}`}>
                            <i className="fa-solid fa-house"></i>
                            <span className="nav-tooltip">Home</span>
                        </button>

                        {siteCode && (
                            <button onClick={() => setView('preview')} className={`nav-item ${view === 'preview' ? 'active' : ''}`}>
                                <i className={`fa-solid fa-eye ${view !== 'preview' ? 'text-brand-400 drop-shadow-[0_0_8px_rgba(168,85,247,0.8)] animate-pulse' : ''}`}></i>
                                <span className="nav-tooltip">Current Site</span>
                            </button>
                        )}

                        {currentUser && (
                            <button onClick={() => setView('dashboard')} className={`nav-item ${view === 'dashboard' ? 'active' : ''}`}>
                                <i className="fa-regular fa-folder-open"></i>
                                <span className="nav-tooltip">Projects</span>
                            </button>
                        )}
                        
                        {currentUser && (
                            <button onClick={() => setView('profile')} className={`nav-item ${view === 'profile' ? 'active' : ''}`}>
                                <i className="fa-regular fa-user"></i>
                                <span className="nav-tooltip">Profile</span>
                            </button>
                        )}

                        {isAdmin && (
                            <button onClick={() => setView('admin')} className={`nav-item ${view === 'admin' ? 'active' : ''} !text-red-400 hover:!bg-red-500/10`}>
                                <i className="fa-solid fa-shield-halved"></i>
                                <span className="nav-tooltip">Admin</span>
                            </button>
                        )}
                    </div>

                    <div className="mt-auto w-full px-4 flex flex-col gap-4">
                        {currentUser && !isPro && (
                            <button onClick={() => setView('pricing')} className={`nav-item !text-yellow-400 hover:!bg-yellow-400/10 ${view === 'pricing' ? 'active !border-yellow-400/30 !shadow-[0_0_20px_rgba(251,191,36,0.2)]' : ''}`}>
                                <i className="fa-solid fa-crown"></i>
                                <span className="nav-tooltip">Upgrade to PRO</span>
                            </button>
                        )}

                        {!currentUser ? (
                            <button onClick={() => setView('auth')} className="w-full h-12 bg-white text-black rounded-xl font-bold flex items-center justify-center hover:bg-gray-200 transition shadow-[0_0_20px_rgba(255,255,255,0.2)]">
                                <i className="fa-solid fa-right-to-bracket"></i>
                            </button>
                        ) : (
                            <button onClick={handleLogout} className="w-full h-12 text-gray-500 hover:text-red-400 hover:bg-red-500/10 rounded-xl transition flex items-center justify-center">
                                <i className="fa-solid fa-power-off"></i>
                            </button>
                        )}
                    </div>
                </aside>
            );

            return (
                <div className="flex flex-col md:flex-row h-screen overflow-hidden bg-black text-white relative">
                    
                    {isProcessing && (
                        <div className="loader-overlay">
                            <i className="fa-solid fa-circle-notch fa-spin text-brand-400 text-5xl mb-4"></i>
                            <p className="text-white font-mono tracking-widest text-sm animate-pulse mt-4">{processMsg}</p>
                        </div>
                    )}

                    {showTrialPrompt && (
                        <div className="fixed inset-0 z-[99999] flex items-center justify-center bg-black/80 backdrop-blur-md animate-fade-in px-4">
                            <div className="premium-panel p-8 md:p-10 max-w-md w-full text-center border border-yellow-500/30 shadow-[0_0_50px_rgba(234,179,8,0.2)]">
                                <div className="w-20 h-20 bg-yellow-500/10 border border-yellow-500/30 rounded-full flex items-center justify-center mx-auto mb-6">
                                    <i className="fa-solid fa-gift text-4xl text-yellow-400"></i>
                                </div>
                                <h3 className="font-display font-bold text-3xl text-white mb-3">Claim Your Free Trial</h3>
                                <p className="text-gray-400 text-sm mb-8 leading-relaxed font-light">Would you like to activate your 1-week free PRO trial now? You'll get full access to all premium architectures, custom colors, and export without watermarks.</p>
                                <div className="flex flex-col gap-4">
                                    <button onClick={handleRedeemTrial} className="w-full bg-gradient-to-r from-yellow-500 to-yellow-600 text-black py-4 rounded-xl text-xs font-bold tracking-widest hover:scale-105 transition transform shadow-[0_0_15px_rgba(234,179,8,0.4)]">
                                        START 1-WEEK FREE TRIAL
                                    </button>
                                    <button onClick={() => setShowTrialPrompt(false)} className="w-full text-gray-500 hover:text-white py-2 text-[10px] font-bold tracking-widest transition uppercase underline decoration-gray-700 hover:decoration-white underline-offset-4">
                                        Maybe Later
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {currentUser && isPro && (
                        <div className={`fixed z-[100] hidden md:block animate-fade-in pointer-events-auto transition-all duration-700 ease-in-out cursor-pointer hover:scale-105 ${view === 'preview' ? 'bottom-8 right-8' : 'top-6 right-8'}`} onClick={() => setView('pricing')}>
                            {isTrialActive && !isPermanentlyPro ? (
                                <span className="pro-badge shadow-[0_0_20px_rgba(251,191,36,0.4)] text-[10px] flex items-center gap-2"><i className="fa-solid fa-clock"></i> TRIAL</span>
                            ) : (
                                <span className="pro-badge shadow-[0_0_20px_rgba(251,191,36,0.4)] text-[10px]">PRO</span>
                            )}
                        </div>
                    )}

                    <div className="fixed inset-0 pointer-events-none z-[-1] bg-grid">
                        <div className="absolute top-[-10%] left-[20%] w-[50%] h-[50%] bg-brand-600 rounded-full mix-blend-screen filter blur-[180px] opacity-[0.15] animate-blob"></div>
                        <div className="absolute bottom-[-10%] right-[10%] w-[40%] h-[40%] bg-indigo-500 rounded-full mix-blend-screen filter blur-[180px] opacity-[0.15] animate-blob" style={{animationDelay: '2s'}}></div>
                    </div>

                    {toast && (
                        <div className="fixed top-8 left-1/2 transform -translate-x-1/2 z-[999] toast-enter">
                            <div className={`premium-panel px-6 py-3 rounded-full shadow-2xl flex items-center gap-3 border ${toast.type === 'error' ? 'border-red-500/50' : 'border-brand-500/50'}`}>
                                <i className={`fa-solid ${toast.type === 'error' ? 'fa-triangle-exclamation text-red-400' : 'fa-circle-check text-brand-400'}`}></i>
                                <span className="font-medium text-sm text-white tracking-wide">{toast.msg}</span>
                            </div>
                        </div>
                    )}

                    <MobileNav />
                    <GlassSidebar />

                    <main className="flex-1 md:ml-[112px] overflow-hidden relative z-10 flex flex-col h-full">
                        
                        {view === 'home' && (
                            <div className="w-full h-full overflow-y-auto pb-20 scroll-smooth">
                                <div className="min-h-[90vh] flex flex-col items-center justify-center text-center p-6 relative overflow-hidden animate-fade-up">
                                    <div className="hero-glow animate-glow-pulse"></div>
                                    <div className="relative z-10 max-w-5xl mx-auto flex flex-col items-center pt-10 md:pt-0">
                                        <div className="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-brand-500/10 text-brand-400 text-xs font-bold mb-8 border border-brand-500/20 shadow-[0_0_15px_rgba(139,92,246,0.15)]">
                                            <span className="w-2 h-2 rounded-full bg-brand-400 animate-pulse"></span>
                                            V8 Engine: AI Architecture & Design
                                        </div>
                                        <h1 className="font-display text-5xl md:text-7xl lg:text-[6.5rem] font-black mb-8 tracking-tighter text-white leading-[1.05] drop-shadow-2xl">
                                            From Vision to Enterprise.<br/>
                                            <span className="text-transparent bg-clip-text bg-gradient-to-r from-brand-400 to-indigo-400 italic font-semibold">In 5 Seconds.</span>
                                        </h1>
                                        <p className="text-lg md:text-xl text-gray-400 mb-12 max-w-2xl mx-auto font-light leading-relaxed">
                                            Stop burning capital on slow development agencies. InstantSite AI harnesses advanced CSS architectures to deploy elite, production-ready websites instantly.
                                        </p>
                                        <div className="flex flex-col sm:flex-row gap-4 w-full sm:w-auto">
                                            <button onClick={handleGetStarted} className="btn-shine px-12 py-5 rounded-2xl text-white font-bold text-sm tracking-widest shadow-2xl flex items-center justify-center gap-3">
                                                GENERATE MY WEBSITE NOW <i className="fa-solid fa-arrow-down"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div className="max-w-6xl mx-auto px-6 py-10 z-10 relative animate-fade-up" style={{animationDelay: '0.2s'}}>
                                    <div className="grid md:grid-cols-2 gap-8">
                                        <div className="premium-panel p-10 relative overflow-hidden group hover:border-brand-500/50 transition duration-500">
                                            <div className="absolute -right-10 -top-10 w-40 h-40 bg-brand-500/10 blur-[50px] rounded-full group-hover:bg-brand-500/20 transition duration-700"></div>
                                            <div className="w-14 h-14 bg-black border border-white/10 rounded-2xl flex items-center justify-center mb-6 shadow-inner relative z-10">
                                                <i className="fa-solid fa-bolt text-2xl text-brand-400"></i>
                                            </div>
                                            <h3 className="font-display font-bold text-2xl text-white mb-4 relative z-10">The InstantSite Engine</h3>
                                            <p className="text-gray-400 leading-relaxed font-light relative z-10">A proprietary AI engine designed to eliminate the friction of web development. By leveraging pre-compiled, pure-CSS architectures, we guarantee perfect lighthouse scores, flawless mobile responsiveness, and zero-dependency deployments right out of the box.</p>
                                        </div>
                                        <div className="premium-panel p-10 relative overflow-hidden group hover:border-indigo-500/50 transition duration-500">
                                            <div className="absolute -left-10 -bottom-10 w-40 h-40 bg-indigo-500/10 blur-[50px] rounded-full group-hover:bg-indigo-500/20 transition duration-700"></div>
                                            <div className="w-14 h-14 bg-black border border-white/10 rounded-2xl flex items-center justify-center mb-6 shadow-inner relative z-10">
                                                <i className="fa-solid fa-microchip text-2xl text-indigo-400"></i>
                                            </div>
                                            <h3 className="font-display font-bold text-2xl text-white mb-4 relative z-10">About DBP Systems</h3>
                                            <p className="text-gray-400 leading-relaxed font-light relative z-10">DBP Systems is a forward-thinking technology hub specializing in next-generation web platforms, hardware automation, and robotics interfaces. We build elite, high-performance tools engineered specifically for the modern entrepreneur and visionary.</p>
                                        </div>
                                    </div>
                                </div>

                                {isBuilderRevealed && (
                                    <div id="builder-section" className="flex flex-col items-center justify-start p-6 py-20 max-w-6xl mx-auto w-full animate-fade-up">
                                        <div className="text-center max-w-4xl mb-14 border-t border-white/5 pt-20">
                                            <h2 className="font-display text-4xl md:text-5xl font-bold mb-4 tracking-tight text-white">
                                                Build Your Website.
                                            </h2>
                                            <p className="text-gray-400 text-lg font-light">Tell us about your business, and our AI will generate a complete website in seconds.</p>
                                        </div>

                                        <div className="w-full flex flex-col gap-6 relative z-10">
                                            <div className="grid lg:grid-cols-3 gap-6 items-stretch">
                                                
                                                <div className="premium-panel p-6 md:p-8 flex flex-col border border-white/5 shadow-2xl h-full">
                                                    <h2 className="font-display font-bold text-lg text-white border-b border-white/10 pb-4 mb-6 flex items-center gap-3">
                                                        <i className="fa-solid fa-id-card text-brand-400"></i> 1. Basic Information
                                                    </h2>
                                                    <div className="flex flex-col justify-between gap-5 flex-grow">
                                                        <div>
                                                            <label className="block text-[10px] font-bold text-gray-500 mb-2 uppercase tracking-widest">Business Name *</label>
                                                            <div className="input-wrapper"><i className="fa-solid fa-building input-icon"></i><input type="text" placeholder="e.g. DBP Electronics" value={form.name} onChange={e => setForm({...form, name: e.target.value})} className="input-glass"/></div>
                                                        </div>
                                                        <div>
                                                            <label className="block text-[10px] font-bold text-gray-500 mb-2 uppercase tracking-widest">Business Type *</label>
                                                            <div className="input-wrapper"><i className="fa-solid fa-tags input-icon"></i><input type="text" placeholder="e.g. Repair Shop" value={form.type} onChange={e => setForm({...form, type: e.target.value})} className="input-glass"/></div>
                                                        </div>
                                                        <div>
                                                            <label className="block text-[10px] font-bold text-gray-500 mb-2 uppercase tracking-widest">City *</label>
                                                            <div className="input-wrapper"><i className="fa-solid fa-location-dot input-icon"></i><input type="text" placeholder="e.g. Patna" value={form.city} onChange={e => setForm({...form, city: e.target.value})} className="input-glass"/></div>
                                                        </div>
                                                        <div className="mt-auto pt-2">
                                                            <label className="block text-[10px] font-bold text-gray-500 mb-2 uppercase tracking-widest">WhatsApp Number *</label>
                                                            <div className="input-wrapper"><i className="fa-brands fa-whatsapp input-icon"></i><input type="tel" placeholder="e.g. 9827700975" value={form.phone} onChange={e => setForm({...form, phone: e.target.value})} className="input-glass"/></div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div className="premium-panel p-6 md:p-8 flex flex-col border border-white/5 shadow-2xl h-full">
                                                    <h2 className="font-display font-bold text-lg text-white border-b border-white/10 pb-4 mb-6 flex items-center gap-3">
                                                        <i className="fa-solid fa-pen-nib text-brand-400"></i> 2. Website Content
                                                    </h2>
                                                    <div className="flex flex-col justify-between gap-5 flex-grow">
                                                        <div className="flex-1 flex flex-col">
                                                            <label className="block text-[10px] font-bold text-gray-500 mb-2 uppercase tracking-widest">About Your Business</label>
                                                            <div className="input-wrapper items-start flex-1 h-full">
                                                                <i className="fa-solid fa-quote-left input-icon textarea-icon"></i>
                                                                <textarea placeholder="Tell us what makes your business special. We will auto-write professional text based on this..." value={form.description} onChange={e => setForm({...form, description: e.target.value})} className="input-glass h-full min-h-[80px] resize-none"></textarea>
                                                            </div>
                                                        </div>
                                                        <div className="grid grid-cols-2 gap-4">
                                                            <div>
                                                                <label className="block text-[10px] font-bold text-gray-500 mb-2 uppercase tracking-widest">Show Prices?</label>
                                                                <div className="input-wrapper">
                                                                    <select value={form.hasPricing} onChange={e => setForm({...form, hasPricing: e.target.value})} className="input-glass">
                                                                        <option value="no">No prices</option>
                                                                        <option value="yes">Yes, show prices</option>
                                                                    </select>
                                                                    <i className="fa-solid fa-chevron-down absolute right-4 text-gray-500 pointer-events-none text-xs"></i>
                                                                </div>
                                                            </div>
                                                            <div>
                                                                <label className="block text-[10px] font-bold text-gray-500 mb-2 uppercase tracking-widest">Show Address?</label>
                                                                <div className="input-wrapper">
                                                                    <select value={form.hasAddress} onChange={e => setForm({...form, hasAddress: e.target.value})} className="input-glass">
                                                                        <option value="no">No address</option>
                                                                        <option value="yes">Yes, show address</option>
                                                                    </select>
                                                                    <i className="fa-solid fa-chevron-down absolute right-4 text-gray-500 pointer-events-none text-xs"></i>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        {form.hasPricing === 'yes' && (
                                                            <div className="animate-fade-in">
                                                                <label className="block text-[10px] font-bold text-brand-400 mb-2 uppercase tracking-widest">Starting Price *</label>
                                                                <div className="input-wrapper">
                                                                    <i className="fa-solid fa-indian-rupee-sign input-icon text-brand-400"></i>
                                                                    <input type="text" placeholder="e.g. 500, or Starts at ₹499" value={form.pricingDetails} onChange={e => setForm({...form, pricingDetails: e.target.value})} className="input-glass border-brand-500/30 focus:border-brand-500"/>
                                                                </div>
                                                            </div>
                                                        )}
                                                        {form.hasAddress === 'yes' && (
                                                            <div className="animate-fade-in">
                                                                <label className="block text-[10px] font-bold text-brand-400 mb-2 uppercase tracking-widest">Full Address *</label>
                                                                <div className="input-wrapper items-start">
                                                                    <i className="fa-solid fa-map-location-dot input-icon textarea-icon text-brand-400"></i>
                                                                    <textarea placeholder="e.g. 123 Main St, Near Park..." value={form.address} onChange={e => setForm({...form, address: e.target.value})} className="input-glass h-12 py-3 resize-none border-brand-500/30 focus:border-brand-500"></textarea>
                                                                </div>
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>

                                                <div className="premium-panel p-6 md:p-8 flex flex-col border border-white/5 shadow-2xl h-full">
                                                    <h2 className="font-display font-bold text-lg text-white border-b border-white/10 pb-4 mb-6 flex items-center gap-3">
                                                        <i className="fa-solid fa-layer-group text-brand-400"></i> 3. Layout & Features
                                                    </h2>
                                                    <div className="flex flex-col justify-between gap-5 flex-grow">
                                                        <div>
                                                            <label className="block text-[10px] font-bold text-gray-500 mb-3 uppercase tracking-widest">Top Banner Style</label>
                                                            <div className="grid grid-cols-3 gap-2">
                                                                <button onClick={() => setForm({...form, heroStyle: 'center'})} className={`p-2 rounded-lg border ${form.heroStyle==='center'?'border-brand-500 bg-brand-500/10 text-brand-400 shadow-inner':'border-white/10 bg-black/50 text-gray-400 hover:bg-black/80'} text-[10px] font-bold transition flex flex-col items-center gap-1.5`}><i className="fa-solid fa-align-center text-sm"></i>Centered</button>
                                                                <button onClick={() => setForm({...form, heroStyle: 'split'})} className={`p-2 rounded-lg border ${form.heroStyle==='split'?'border-brand-500 bg-brand-500/10 text-brand-400 shadow-inner':'border-white/10 bg-black/50 text-gray-400 hover:bg-black/80'} text-[10px] font-bold transition flex flex-col items-center gap-1.5`}><i className="fa-solid fa-columns text-sm"></i>Split</button>
                                                                <button onClick={() => setForm({...form, heroStyle: 'minimal'})} className={`p-2 rounded-lg border ${form.heroStyle==='minimal'?'border-brand-500 bg-brand-500/10 text-brand-400 shadow-inner':'border-white/10 bg-black/50 text-gray-400 hover:bg-black/80'} text-[10px] font-bold transition flex flex-col items-center gap-1.5`}><i className="fa-solid fa-align-left text-sm"></i>Minimal</button>
                                                            </div>
                                                        </div>
                                                        <div>
                                                            <label className="block text-[10px] font-bold text-gray-500 mb-3 uppercase tracking-widest">Sections to Include</label>
                                                            <div className="space-y-2">
                                                                <label className="flex items-center justify-between p-3 rounded-lg border border-white/5 bg-black/30 cursor-pointer hover:bg-black/50 transition">
                                                                    <span className="text-xs font-medium text-gray-300"><i className="fa-solid fa-images text-brand-400 w-5"></i> Photo Gallery</span>
                                                                    <div className="relative inline-block w-8 mr-2 align-middle select-none transition duration-200 ease-in">
                                                                        <input type="checkbox" checked={form.showGallery} onChange={(e) => setForm({...form, showGallery: e.target.checked})} className="toggle-checkbox absolute block w-4 h-4 rounded-full bg-white border-4 border-gray-600 appearance-none cursor-pointer transition-all duration-300 z-10"/>
                                                                        <label className="toggle-label block overflow-hidden h-4 rounded-full bg-gray-600 cursor-pointer transition-colors duration-300"></label>
                                                                    </div>
                                                                </label>
                                                                <label className="flex items-center justify-between p-3 rounded-lg border border-white/5 bg-black/30 cursor-pointer hover:bg-black/50 transition">
                                                                    <span className="text-xs font-medium text-gray-300"><i className="fa-solid fa-quote-left text-brand-400 w-5"></i> Customer Reviews</span>
                                                                    <div className="relative inline-block w-8 mr-2 align-middle select-none transition duration-200 ease-in">
                                                                        <input type="checkbox" checked={form.showTestimonials} onChange={(e) => setForm({...form, showTestimonials: e.target.checked})} className="toggle-checkbox absolute block w-4 h-4 rounded-full bg-white border-4 border-gray-600 appearance-none cursor-pointer transition-all duration-300 z-10"/>
                                                                        <label className="toggle-label block overflow-hidden h-4 rounded-full bg-gray-600 cursor-pointer transition-colors duration-300"></label>
                                                                    </div>
                                                                </label>
                                                                <label className="flex items-center justify-between p-3 rounded-lg border border-white/5 bg-black/30 cursor-pointer hover:bg-black/50 transition">
                                                                    <span className="text-xs font-medium text-gray-300"><i className="fa-solid fa-circle-question text-brand-400 w-5"></i> Frequently Asked Questions</span>
                                                                    <div className="relative inline-block w-8 mr-2 align-middle select-none transition duration-200 ease-in">
                                                                        <input type="checkbox" checked={form.showFAQ} onChange={(e) => setForm({...form, showFAQ: e.target.checked})} className="toggle-checkbox absolute block w-4 h-4 rounded-full bg-white border-4 border-gray-600 appearance-none cursor-pointer transition-all duration-300 z-10"/>
                                                                        <label className="toggle-label block overflow-hidden h-4 rounded-full bg-gray-600 cursor-pointer transition-colors duration-300"></label>
                                                                    </div>
                                                                </label>
                                                            </div>
                                                        </div>
                                                        <div className="mt-auto pt-4">
                                                            <label className="flex justify-between text-[10px] font-bold text-gray-500 mb-2 uppercase tracking-widest"><span>List Your Main Services</span>{!isPro && <span className="text-yellow-500"><i className="fa-solid fa-lock"></i> PRO</span>}</label>
                                                            <div className="input-wrapper items-start">
                                                                <i className="fa-solid fa-list-check input-icon textarea-icon"></i>
                                                                <textarea placeholder={isPro ? "e.g. Screen Repair, Battery Replacement" : "Locked in Free Tier"} value={form.services} onChange={e => setForm({...form, services: e.target.value})} disabled={!isPro} className={`input-glass h-[3.5rem] resize-none ${!isPro && 'bg-black/50 border-white/5'}`}></textarea>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div className="w-full premium-panel p-6 md:p-8 relative z-10 border border-white/5 shadow-2xl">
                                                <h2 className="font-display font-bold text-lg text-white border-b border-white/10 pb-4 mb-6 flex items-center gap-3">
                                                    <i className="fa-solid fa-palette text-brand-400"></i> 4. Colors & Template
                                                </h2>
                                                
                                                <div className="grid lg:grid-cols-4 gap-8 lg:gap-12 items-start">
                                                    <div className="lg:col-span-1 lg:border-r border-white/5 lg:pr-8 flex flex-col gap-6">
                                                        <div>
                                                            <label className="block text-[10px] font-bold text-gray-500 mb-4 uppercase tracking-widest">Choose a Color Theme</label>
                                                            <div className="flex flex-wrap gap-3">
                                                                {presetColors.map(c => (
                                                                    <button key={c} onClick={() => handleColorSelect(c)} className={`w-8 h-8 rounded-full cursor-pointer transition transform ${form.color === c ? 'scale-110 ring-2 ring-white ring-offset-2 ring-offset-[#0a0a0a] shadow-[0_0_15px_currentColor]' : 'opacity-50 hover:opacity-100 hover:scale-110 shadow-inner border border-white/10'}`} style={{backgroundColor: c}}/>
                                                                ))}
                                                                <div className="w-px h-8 bg-white/10 mx-1"></div>
                                                                {proColors.map(c => (
                                                                    <button key={c} onClick={() => handleColorSelect(c)} className={`relative w-8 h-8 rounded-full cursor-pointer transition transform ${form.color === c ? 'scale-110 ring-2 ring-white ring-offset-2 ring-offset-[#0a0a0a] shadow-[0_0_15px_currentColor]' : 'opacity-50 hover:opacity-100 hover:scale-110 shadow-inner border border-white/10'} ${!isPro && 'opacity-30 cursor-not-allowed'}`} style={{backgroundColor: c}}>
                                                                        {!isPro && <i className="fa-solid fa-lock text-[8px] text-white absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-20 opacity-80"></i>}
                                                                    </button>
                                                                ))}
                                                            </div>
                                                        </div>
                                                        <div className="pt-2">
                                                            <label className="flex justify-between text-[10px] font-bold text-gray-500 mb-3 uppercase tracking-widest"><span>Pick Custom Color</span>{!isPro && <span className="text-yellow-500"><i className="fa-solid fa-lock"></i> PRO</span>}</label>
                                                            <div className="flex items-center gap-3">
                                                                <div className={`relative w-10 h-10 rounded-xl overflow-hidden border border-white/20 flex-shrink-0 transition ${!isPro ? 'opacity-30 cursor-not-allowed' : 'hover:border-white shadow-inner'}`}>
                                                                    {!isPro && <i className="fa-solid fa-lock text-[10px] text-white absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-20"></i>}
                                                                    <input type="color" value={form.color.startsWith('#') ? form.color : '#8b5cf6'} onChange={e => {if(isPro) setForm({...form, color: e.target.value})}} className="absolute inset-0 w-[200%] h-[200%] -top-1/2 -left-1/2 cursor-pointer bg-transparent border-0 p-0" disabled={!isPro}/>
                                                                </div>
                                                                <input type="text" value={form.color} onChange={e => {if(isPro) setForm({...form, color: e.target.value})}} disabled={!isPro} placeholder="#HEXCODE or rgb()" className={`input-glass input-glass-no-icon h-10 flex-1 font-mono text-xs ${!isPro ? 'opacity-30 cursor-not-allowed' : ''}`} />
                                                            </div>
                                                        </div>
                                                        <div className="pt-4 border-t border-white/5">
                                                            <label className="flex justify-between text-[10px] font-bold text-gray-500 mb-2 uppercase tracking-widest"><span>Google Search Keywords</span>{!isPro && <span className="text-yellow-500"><i className="fa-solid fa-lock"></i> PRO</span>}</label>
                                                            <div className="input-wrapper">
                                                                <i className="fa-solid fa-magnifying-glass input-icon"></i>
                                                                <input type="text" placeholder={isPro ? "e.g. best repair, quick fix" : "Locked in Free Tier"} value={form.seo} onChange={e => setForm({...form, seo: e.target.value})} disabled={!isPro} className={`input-glass ${!isPro && 'bg-black/50 border-white/5'}`}/>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div className="lg:col-span-3">
                                                        <label className="block text-[10px] font-bold text-gray-500 mb-4 uppercase tracking-widest">Select a Website Design Template</label>
                                                        <div className="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3">
                                                            
                                                            {['ai-dark', 'ai-light'].map(tmpl => (
                                                                <button key={tmpl} onClick={() => handleTemplateSelect(tmpl)} className={`relative p-3 rounded-xl border ${form.template === tmpl ? 'border-brand-500 bg-brand-500/20 shadow-[0_0_20px_rgba(168,85,247,0.4)]' : 'border-brand-500/30 bg-brand-500/5 hover:border-brand-500/60'} transition flex flex-col items-center justify-center gap-2 ${!isPro && 'opacity-50 cursor-not-allowed'}`}>
                                                                    {!isPro && <span className="absolute -top-2 right-0 text-[8px] text-red-400 bg-red-400/10 px-1 rounded border border-red-400/20 font-bold"><i className="fa-solid fa-lock"></i> PRO</span>}
                                                                    <div className="absolute top-1 left-1 text-brand-400 animate-pulse text-[8px]"><i className="fa-solid fa-sparkles"></i></div>
                                                                    {tmpl==='ai-dark' && <div className="w-full h-6 bg-black border border-white/20 rounded flex items-center justify-center p-1 shadow-[inset_0_0_10px_rgba(255,255,255,0.1)]"><div className="w-2 h-2 rounded-full bg-brand-500 shadow-[0_0_10px_#a855f7]"></div></div>}
                                                                    {tmpl==='ai-light' && <div className="w-full h-6 bg-white border border-gray-200 rounded flex items-center justify-center p-1 shadow-[0_4px_10px_rgba(0,0,0,0.05)]"><div className="w-2 h-2 rounded-full bg-brand-500"></div></div>}
                                                                    <span className="text-[9px] font-black text-brand-400 uppercase tracking-widest truncate w-full text-center">{tmpl.replace('-', ' ')}</span>
                                                                </button>
                                                            ))}

                                                            {['minimal', 'bento'].map(tmpl => (
                                                                <button key={tmpl} onClick={() => handleTemplateSelect(tmpl)} className={`p-3 rounded-xl border ${form.template === tmpl ? 'border-brand-500 bg-brand-500/10 shadow-[0_0_15px_rgba(168,85,247,0.2)]' : 'border-white/5 bg-black/50 hover:border-white/20'} transition flex flex-col items-center justify-center gap-2`}>
                                                                    <div className={`w-full h-6 ${tmpl==='minimal'?'bg-gray-200 flex-col':'bg-white grid grid-cols-2'} rounded opacity-80 flex gap-1 p-0.5`}>
                                                                        {tmpl==='minimal' ? <><div className="h-0.5 bg-gray-400 w-3/4"></div><div className="h-0.5 bg-gray-400 w-1/2"></div></> : <><div className="bg-gray-300 rounded-sm"></div><div className="bg-gray-300 rounded-sm"></div></>}
                                                                    </div>
                                                                    <span className="text-[9px] font-bold text-gray-400 uppercase tracking-widest">{tmpl}</span>
                                                                </button>
                                                            ))}

                                                            {['dark', 'corporate', 'creative', 'neon', 'midnight', 'matrix', 'glassmorphism', 'brutalism'].map(tmpl => (
                                                                <button key={tmpl} onClick={() => handleTemplateSelect(tmpl)} className={`relative p-3 rounded-xl border ${form.template === tmpl ? 'border-brand-500 bg-brand-500/10 shadow-[0_0_15px_rgba(168,85,247,0.2)]' : 'border-white/5 bg-black/50 hover:border-white/20'} transition flex flex-col items-center justify-center gap-2 ${!isPro && 'opacity-50 cursor-not-allowed'}`}>
                                                                    {!isPro && <span className="absolute -top-2 right-0 text-[8px] text-red-400 bg-red-400/10 px-1 rounded border border-red-400/20 font-bold"><i className="fa-solid fa-lock"></i> PRO</span>}
                                                                    {tmpl==='dark' && <div className="w-full h-6 bg-gray-900 border border-gray-700 rounded flex items-center justify-center p-1"><div className="w-1.5 h-1.5 rounded-full bg-brand-500 shadow-[0_0_8px_#a855f7]"></div></div>}
                                                                    {tmpl==='corporate' && <div className="w-full h-6 bg-slate-100 border border-slate-300 rounded flex flex-col gap-0.5 p-1"><div className="h-1 bg-slate-400 w-full rounded-sm"></div><div className="h-1 bg-slate-300 w-full rounded-sm"></div></div>}
                                                                    {tmpl==='creative' && <div className="w-full h-6 bg-white border border-black rounded flex items-center justify-center p-0.5 transform -rotate-3"><div className="w-3 h-0.5 bg-black"></div></div>}
                                                                    {tmpl==='neon' && <div className="text-xl mb-0.5 text-green-400 drop-shadow-[0_0_10px_#4ade80]"><i className="fa-solid fa-bolt"></i></div>}
                                                                    {tmpl==='midnight' && <div className="text-xl mb-0.5 text-indigo-300"><i className="fa-solid fa-star"></i></div>}
                                                                    {tmpl==='matrix' && <div className="text-xl mb-0.5 text-green-500"><i className="fa-solid fa-terminal"></i></div>}
                                                                    {tmpl==='glassmorphism' && <div className="text-xl mb-0.5 text-white/60 drop-shadow-sm"><i className="fa-regular fa-clone"></i></div>}
                                                                    {tmpl==='brutalism' && <div className="text-xl mb-0.5 text-white font-black tracking-tighter">B</div>}
                                                                    <span className="text-[9px] font-bold text-gray-400 uppercase tracking-widest truncate w-full text-center">{tmpl}</span>
                                                                </button>
                                                            ))}
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <button onClick={handleGenerate} className="w-full mt-10 text-white font-display font-bold text-lg py-5 rounded-xl btn-shine flex justify-center items-center gap-3 tracking-widest shadow-[0_15px_40px_rgba(168,85,247,0.4)]">
                                                    <i className="fa-solid fa-microchip text-xl"></i> GENERATE MY WEBSITE NOW
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}

                        {view === 'generating' && (
                            <div className="flex-1 flex flex-col items-center justify-center p-6 animate-fade-in">
                                <div className="w-full max-w-3xl terminal-window border border-white/10 shadow-2xl">
                                    <div className="bg-black border-b border-white/10 p-4 flex items-center gap-4">
                                        <div className="flex gap-2"><div className="w-3 h-3 rounded-full bg-red-500/80"></div><div className="w-3 h-3 rounded-full bg-yellow-500/80"></div><div className="w-3 h-3 rounded-full bg-green-500/80"></div></div>
                                        <div className="text-xs text-gray-500 font-mono pl-4 border-l border-white/10">AI_Engine:~</div>
                                    </div>
                                    <div className="p-8 h-[400px] overflow-y-auto space-y-3 hacker-text text-sm bg-black/90">
                                        {loadingLogs.map((log, index) => (<div key={index} className="opacity-80">{log}</div>))}
                                        <div ref={terminalEndRef} className="animate-pulse inline-block">█</div>
                                    </div>
                                </div>
                                <div className="w-full max-w-3xl mt-8">
                                    <div className="flex justify-between text-xs font-mono font-bold text-brand-400 mb-3 tracking-widest">
                                        <span>BUILDING YOUR WEBSITE</span><span>{loadingProgress}%</span>
                                    </div>
                                    <div className="w-full bg-black border border-white/10 h-1.5 overflow-hidden rounded-full">
                                        <div className="bg-brand-500 h-full shadow-[0_0_15px_#8b5cf6] transition-all duration-200 ease-out" style={{width: `${loadingProgress}%`}}></div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {view === 'preview' && (
                            <div className="flex-1 flex flex-col h-full overflow-hidden animate-fade-in relative">
                                <div className="glass-nav border-x-0 border-t-0 p-3 px-6 flex flex-wrap gap-4 items-center justify-between z-10 flex-shrink-0 shadow-lg">
                                    <div className="flex items-center gap-4">
                                        <div className="flex items-center bg-black/50 rounded-lg p-1 border border-white/5 shadow-inner">
                                            <button onClick={() => setPreviewMode('desktop')} className={`px-4 py-1.5 rounded-md text-xs font-bold tracking-widest transition flex items-center gap-2 ${previewMode === 'desktop' ? 'bg-white/10 text-white shadow-md border border-white/5' : 'text-gray-500 hover:text-gray-300'}`}><i className="fa-solid fa-desktop text-sm"></i> <span className="hidden sm:block">DESKTOP</span></button>
                                            <button onClick={() => setPreviewMode('mobile')} className={`px-4 py-1.5 rounded-md text-xs font-bold tracking-widest transition flex items-center gap-2 ${previewMode === 'mobile' ? 'bg-white/10 text-white shadow-md border border-white/5' : 'text-gray-500 hover:text-gray-300'}`}><i className="fa-solid fa-mobile-screen text-sm"></i> <span className="hidden sm:block">MOBILE</span></button>
                                        </div>
                                        <div className="h-6 w-px bg-white/10 hidden sm:block"></div>
                                        <div className="flex items-center bg-black/50 rounded-lg p-1 border border-white/5 shadow-inner">
                                            <button onClick={() => toggleEditMode(true)} className={`px-4 py-1.5 rounded-md text-xs font-bold tracking-widest transition flex items-center gap-2 ${isEditMode ? 'bg-brand-600 text-white shadow-md' : 'text-gray-500 hover:text-gray-300'}`}><i className="fa-solid fa-pen-nib"></i> <span className="hidden sm:block">EDIT</span></button>
                                            <button onClick={() => toggleEditMode(false)} className={`px-4 py-1.5 rounded-md text-xs font-bold tracking-widest transition flex items-center gap-2 ${!isEditMode ? 'bg-green-600 text-white shadow-md' : 'text-gray-500 hover:text-gray-300'}`}><i className="fa-solid fa-eye"></i> <span className="hidden sm:block">VIEW</span></button>
                                        </div>
                                    </div>
                                    <div className="flex gap-4 items-center">
                                        <button onClick={() => launchLiveSite(siteCodeRef.current)} className="bg-gradient-to-r from-green-500 to-emerald-600 text-white px-5 py-2 rounded-lg text-xs font-bold tracking-widest hover:opacity-90 transition flex items-center gap-2 shadow-[0_0_15px_rgba(16,185,129,0.3)]"><i className="fa-solid fa-rocket"></i> <span className="hidden sm:block">LAUNCH LIVE</span></button>
                                        <button onClick={saveProjectToCloud} className="text-brand-400 hover:text-white px-4 py-2 rounded-lg text-xs font-bold tracking-widest transition flex items-center gap-2 border border-brand-500/30 bg-brand-500/10 hover:bg-brand-500/20"><i className="fa-solid fa-cloud-arrow-up"></i> <span className="hidden sm:block">SAVE</span></button>
                                        <button onClick={() => setView('pricing')} className="bg-white text-black px-5 py-2 rounded-lg text-xs font-bold tracking-widest hover:bg-gray-200 transition shadow-[0_0_20px_rgba(255,255,255,0.2)] flex items-center gap-2">EXPORT <i className="fa-solid fa-arrow-right"></i></button>
                                    </div>
                                </div>
                                
                                <div className="preview-outer-wrapper">
                                    {isEditMode && (
                                        <div className="absolute top-6 z-50 bg-brand-600 border border-brand-400 text-white text-xs font-bold tracking-widest px-5 py-2.5 rounded-lg shadow-[0_10px_25px_rgba(139,92,246,0.4)] flex items-center gap-3 animate-bounce pointer-events-none">
                                            <i className="fa-solid fa-pen-nib"></i> CLICK ANY TEXT OR IMAGE TO EDIT
                                        </div>
                                    )}
                                    <div className={`device-morph mode-${previewMode}`}>
                                        <div className="device-camera"></div>
                                        <div className="mobile-home-indicator"></div>
                                        <div className="browser-bar">
                                            <div className="flex gap-2 w-16"><div className="w-3 h-3 rounded-full bg-red-500/80"></div><div className="w-3 h-3 rounded-full bg-yellow-500/80"></div><div className="w-3 h-3 rounded-full bg-green-500/80"></div></div>
                                            <div className="flex-1 flex justify-center"><div className="bg-black border border-white/5 text-[10px] font-mono text-gray-500 px-6 py-1 rounded w-1/2 max-w-sm text-center flex items-center justify-center gap-2 shadow-inner"><i className="fa-solid fa-lock text-brand-500"></i>{(form.name || 'preview').toLowerCase().replace(/\s+/g, '')}.dbpsites.in</div></div>
                                            <div className="w-16"></div>
                                        </div>
                                        <iframe ref={iframeRef} srcDoc={siteCode} className="w-full flex-1 border-none bg-white"></iframe>
                                    </div>
                                    <div className={`desktop-base-wrapper ${previewMode === 'desktop' ? 'desktop-active' : ''}`}>
                                        <div className="desktop-base"></div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {view === 'pricing' && (
                            <div className="flex-1 h-full overflow-y-auto py-16 px-6 animate-fade-up relative">
                                <div className="hero-glow opacity-50"></div>
                                <div className="text-center max-w-3xl mx-auto mb-16 relative z-10">
                                    <button onClick={() => setView('preview')} className="text-gray-500 hover:text-white text-xs font-bold tracking-widest flex items-center gap-2 mx-auto transition mb-8 uppercase"><i className="fa-solid fa-arrow-left"></i> Back to Editor</button>
                                    <h2 className="font-display text-4xl md:text-6xl font-bold mb-4 text-white tracking-tighter flex items-center justify-center gap-4">Export Architecture</h2>
                                    <p className="text-gray-400 text-lg font-light">Download the enterprise-grade source code for free, or upgrade to PRO to remove watermarks and unlock the full matrix.</p>
                                </div>

                                <div className="max-w-4xl mx-auto grid md:grid-cols-2 gap-8 items-start relative z-10">
                                    <div className="premium-panel p-10 border border-white/5 hover:border-white/10 transition duration-300">
                                        <h3 className="font-display font-bold text-2xl mb-2 text-white">Starter Code</h3>
                                        <p className="text-gray-500 text-sm mb-8">Own your code completely.</p>
                                        <div className="flex items-end gap-1 mb-8"><span className="text-5xl font-display font-bold text-white tracking-tighter">₹0</span></div>
                                        <ul className="space-y-4 text-sm text-gray-300 mb-10 font-medium border-t border-white/5 pt-8">
                                            <li className="flex gap-4 items-center"><i className="fa-solid fa-code text-gray-500 w-4"></i> Download HTML/CSS file</li>
                                            <li className="flex gap-4 items-center opacity-50"><i className="fa-solid fa-copyright text-red-400 w-4"></i> Forced DBP Watermark</li>
                                            <li className="flex gap-4 items-center opacity-50"><i className="fa-solid fa-lock text-red-400 w-4"></i> 10 Premium Templates Locked</li>
                                        </ul>
                                        <button onClick={downloadHTML} className="btn-secondary w-full py-4 text-xs font-bold tracking-widest uppercase flex justify-center items-center gap-2 hover:bg-white hover:text-black transition"><i className="fa-solid fa-download"></i> Export Free HTML</button>
                                    </div>

                                    <div className="premium-panel p-10 border border-brand-500/50 shadow-[0_30px_60px_rgba(139,92,246,0.2)] transform md:-translate-y-4 relative z-10">
                                        <div className="absolute -top-4 left-1/2 transform -translate-x-1/2 bg-gradient-to-r from-brand-400 to-brand-600 text-white text-[10px] font-bold px-4 py-1.5 rounded-full uppercase tracking-widest shadow-lg flex items-center gap-2">
                                            Professional Access <span className="offer-badge ml-1">50% OFF</span>
                                        </div>
                                        <h3 className="font-display font-bold text-2xl mb-2 text-white">Pro Editor</h3>
                                        
                                        {isPermanentlyPro ? (
                                            <p className="text-brand-300 text-sm mb-8">You have lifetime PRO access.</p>
                                        ) : isTrialActive ? (
                                            <div className="bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-3 mb-6">
                                                <p className="text-yellow-400 text-xs font-bold uppercase tracking-widest mb-1"><i className="fa-solid fa-clock"></i> Free Trial Active</p>
                                                <p className="text-gray-300 text-xs">Ends in: {getTrialTimeLeft()}</p>
                                            </div>
                                        ) : canRedeemTrial ? (
                                            <p className="text-brand-300 text-sm mb-8">Try all features free for 7 days.</p>
                                        ) : (
                                            <p className="text-red-400 text-sm mb-8">Free trial expired. Upgrade below.</p>
                                        )}
                                        
                                        <div className="flex items-end gap-2 mb-8">
                                            <span className="text-2xl font-display font-bold text-gray-500 tracking-tighter line-through decoration-red-500 decoration-2">₹999</span>
                                            <span className="text-6xl font-display font-bold text-white tracking-tighter text-transparent bg-clip-text bg-gradient-to-r from-brand-400 to-brand-100">₹499</span>
                                            <span className="text-gray-400 font-light mb-2">/yr</span>
                                        </div>
                                        
                                        <ul className="space-y-4 text-sm text-white mb-10 font-medium border-t border-white/10 pt-8">
                                            <li className="flex gap-4 items-center"><i className="fa-solid fa-unlock text-brand-400 w-4"></i> All 12 Templates Unlocked</li>
                                            <li className="flex gap-4 items-center"><i className="fa-solid fa-droplet-slash text-brand-400 w-4"></i> Watermark Completely Removed</li>
                                            <li className="flex gap-4 items-center"><i className="fa-solid fa-palette text-brand-400 w-4"></i> Custom Color Engine</li>
                                            <li className="flex gap-4 items-center"><i className="fa-solid fa-chart-line text-brand-400 w-4"></i> Custom SEO & Advanced Services</li>
                                        </ul>
                                        
                                        {isPro ? (
                                            <div className="flex flex-col gap-3">
                                                <button onClick={downloadHTML} className="w-full py-4 rounded-xl text-xs font-bold tracking-widest bg-white text-black hover:bg-gray-200 transition flex justify-center items-center gap-2 shadow-[0_0_20px_rgba(255,255,255,0.2)]"><i className="fa-solid fa-code"></i> Export Pro HTML</button>
                                                {!isPermanentlyPro && (
                                                    <button onClick={handlePaymentInit} className="w-full py-3 rounded-xl text-xs font-bold tracking-widest btn-shine flex justify-center items-center gap-2 opacity-90 hover:opacity-100 transition">
                                                        <i className="fa-solid fa-bolt"></i> GET PERMANENT PRO
                                                    </button>
                                                )}
                                            </div>
                                        ) : canRedeemTrial ? (
                                            <div className="flex flex-col gap-3">
                                                <button onClick={handleRedeemTrial} className="w-full bg-gradient-to-r from-yellow-500 to-yellow-600 text-black py-4 rounded-xl text-xs font-bold tracking-widest flex justify-center items-center gap-2 shadow-[0_0_15px_rgba(234,179,8,0.4)] hover:scale-105 transition transform">
                                                    <i className="fa-solid fa-gift text-lg"></i> REDEEM 1-WEEK FREE TRIAL
                                                </button>
                                                <button onClick={handlePaymentInit} className="w-full btn-shine py-3 rounded-xl text-xs font-bold tracking-widest flex justify-center items-center gap-2 opacity-90 hover:opacity-100 transition">
                                                    <i className="fa-solid fa-crown"></i> SECURE UPGRADE
                                                </button>
                                            </div>
                                        ) : (
                                            <button onClick={handlePaymentInit} className="w-full py-4 rounded-xl text-xs font-bold tracking-widest btn-shine flex justify-center items-center gap-2">
                                                <i className="fa-solid fa-bolt"></i> GET PRO VIA RAZORPAY
                                            </button>
                                        )}
                                    </div>
                                </div>
                            </div>
                        )}

                        {view === 'auth' && (
                            <div className="flex-1 flex h-full overflow-y-auto items-center justify-center p-6 animate-fade-up">
                                <div className="premium-panel w-full max-w-md p-10 relative overflow-hidden">
                                    <div className="absolute top-0 inset-x-0 h-1 bg-gradient-to-r from-brand-400 to-indigo-500"></div>
                                    <div className="text-center mb-10">
                                        <div className="w-16 h-16 bg-black border border-white/10 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-inner">
                                            <i className="fa-solid fa-fingerprint text-2xl text-brand-400"></i>
                                        </div>
                                        <h2 className="font-display font-bold text-3xl text-white">{authMode === 'login' ? 'Welcome Back' : 'Create Account'}</h2>
                                        <p className="text-gray-500 text-sm mt-2 font-medium">Authenticate to access the DBP Engine.</p>
                                    </div>
                                    <div className="space-y-5">
                                        {authMode === 'signup' && (
                                            <div className="input-wrapper">
                                                <i className="fa-solid fa-user input-icon"></i>
                                                <input type="text" placeholder="Full Name" value={authForm.name} onChange={e => setAuthForm({...authForm, name: e.target.value})} className="input-glass"/>
                                            </div>
                                        )}
                                        <div className="input-wrapper">
                                            <i className="fa-solid fa-phone input-icon"></i>
                                            <input type="tel" placeholder="Phone Number (e.g. 9827700975)" value={authForm.phone} onChange={e => setAuthForm({...authForm, phone: e.target.value})} className="input-glass"/>
                                        </div>
                                        <div className="input-wrapper">
                                            <i className="fa-solid fa-lock input-icon"></i>
                                            <input type="password" placeholder="Secure Password" value={authForm.password} onChange={e => setAuthForm({...authForm, password: e.target.value})} className="input-glass"/>
                                        </div>
                                        
                                        <button onClick={handleAuth} className="w-full btn-shine py-4 rounded-xl mt-4 flex justify-center items-center gap-2">
                                            {authMode === 'login' ? 'SECURE LOGIN' : 'INITIALIZE ACCOUNT'}
                                        </button>
                                        
                                        <div className="text-center mt-6">
                                            <button onClick={() => setAuthMode(authMode === 'login' ? 'signup' : 'login')} className="text-gray-400 text-xs font-bold tracking-widest hover:text-brand-400 transition uppercase">
                                                {authMode === 'login' ? 'Register New Access' : 'Return to Login'}
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {view === 'dashboard' && currentUser && (
                            <div className="flex-1 h-full overflow-y-auto p-6 lg:p-12 animate-fade-up w-full">
                                <div className="max-w-7xl mx-auto w-full">
                                    <div className="flex flex-col md:flex-row justify-between items-start md:items-end mb-10 border-b border-white/10 pb-8 gap-6">
                                        <div>
                                            <h1 className="font-display font-bold text-4xl text-white tracking-tight flex items-center gap-4">
                                                Project Matrix 
                                            </h1>
                                            <p className="text-gray-400 mt-2 font-light">Welcome back, {currentUser.name}. Manage your cloud-saved architectures below.</p>
                                        </div>
                                        <button onClick={() => {setView('home'); setTimeout(handleGetStarted, 100);}} className="btn-shine px-8 py-3.5 rounded-xl text-xs flex items-center gap-2 shadow-lg">
                                            <i className="fa-solid fa-plus text-base"></i> NEW DEPLOYMENT
                                        </button>
                                    </div>
                                    
                                    <div className="grid lg:grid-cols-4 gap-8">
                                        <div className="lg:col-span-3">
                                            {userSites.length === 0 ? (
                                                <div className="premium-panel p-20 text-center flex flex-col items-center">
                                                    <div className="w-24 h-24 bg-black border border-white/10 rounded-full flex items-center justify-center mb-6 shadow-inner">
                                                        <i className="fa-solid fa-folder-open text-3xl text-gray-600"></i>
                                                    </div>
                                                    <h3 className="font-display font-bold text-2xl text-white mb-2">Database Empty</h3>
                                                    <p className="text-gray-500 mb-8 max-w-md font-light">You have no saved projects in the cloud. Initialize the builder to generate your first enterprise site.</p>
                                                    <button onClick={() => {setView('home'); setTimeout(handleGetStarted, 100);}} className="btn-secondary px-8 py-3 text-xs tracking-widest uppercase">Start Building</button>
                                                </div>
                                            ) : (
                                                <div className="grid md:grid-cols-2 gap-8">
                                                    {userSites.map(site => (
                                                        <div key={site.firebaseId} className="premium-panel p-8 flex flex-col group hover:border-brand-500/50 transition duration-500">
                                                            <div className="flex justify-between items-start mb-6">
                                                                <h3 className="font-display font-bold text-2xl text-white truncate pr-4 group-hover:text-brand-400 transition">{site.name}</h3>
                                                                <span className="text-[10px] text-green-400 bg-green-500/10 px-2 py-1 rounded font-bold uppercase tracking-widest border border-green-500/20">Cloud</span>
                                                            </div>
                                                            <p className="text-xs text-gray-500 mb-8 font-mono bg-black/50 p-3 rounded-lg border border-white/5 inline-block w-max"><i className="fa-regular fa-clock text-brand-400 mr-2"></i> {site.date}</p>
                                                            
                                                            <div className="mt-auto grid grid-cols-3 gap-3 border-t border-white/10 pt-6">
                                                                <button onClick={() => launchLiveSite(site.html)} className="bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 hover:bg-emerald-500 hover:text-white py-3 rounded-xl text-xs font-bold transition tracking-widest flex items-center justify-center gap-1">
                                                                    <i className="fa-solid fa-rocket"></i> LIVE
                                                                </button>
                                                                <button onClick={() => loadProject(site.html, site.name)} className="btn-secondary py-3 text-xs font-bold tracking-widest hover:bg-white hover:text-black">
                                                                    RESTORE
                                                                </button>
                                                                <button onClick={() => deleteProject(site.firebaseId)} className="bg-red-500/10 text-red-500 py-3 rounded-xl text-xs font-bold border border-red-500/20 hover:bg-red-500 hover:text-white transition tracking-widest">
                                                                    DELETE
                                                                </button>
                                                            </div>
                                                        </div>
                                                    ))}
                                                </div>
                                            )}
                                        </div>
                                        <div className="lg:col-span-1 space-y-6">
                                            <div className="premium-panel p-6 border-brand-500/30">
                                                <h3 className="text-xs text-brand-400 font-bold tracking-widest uppercase mb-4"><i className="fa-solid fa-chart-line mr-2"></i> Quick Stats</h3>
                                                <div className="space-y-4">
                                                    <div className="bg-black/50 p-4 rounded-xl border border-white/5">
                                                        <p className="text-gray-500 text-xs uppercase tracking-widest mb-1">Total Assets</p>
                                                        <p className="text-3xl font-display font-bold text-white">{userSites.length}</p>
                                                    </div>
                                                    <div className="bg-black/50 p-4 rounded-xl border border-white/5">
                                                        <p className="text-gray-500 text-xs uppercase tracking-widest mb-1">License</p>
                                                        {isPro ? <span className="pro-badge mt-2 text-[10px]">PRO</span> : <span className="text-white font-bold text-sm block mt-1">FREE TIER</span>}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {view === 'profile' && currentUser && (
                            <div className="flex-1 h-full overflow-y-auto p-6 lg:p-12 animate-fade-up w-full">
                                <div className="max-w-7xl mx-auto w-full">
                                    <div className="flex flex-col md:flex-row justify-between items-start md:items-end mb-10 border-b border-white/10 pb-8 gap-6">
                                        <div>
                                            <h1 className="font-display font-bold text-4xl text-white tracking-tight flex items-center gap-4">
                                                System Identity 
                                            </h1>
                                            <p className="text-gray-400 mt-2 font-light">Manage your platform authentication and license credentials.</p>
                                        </div>
                                    </div>

                                    <div className="grid lg:grid-cols-3 gap-8">
                                        <div className="lg:col-span-2 space-y-8">
                                            <div className="premium-panel p-8 flex items-center gap-8">
                                                <div className="w-24 h-24 bg-brand-500/10 border border-brand-500/30 rounded-full flex items-center justify-center shadow-[0_0_30px_rgba(139,92,246,0.2)] flex-shrink-0">
                                                    <i className="fa-solid fa-user text-4xl text-brand-400"></i>
                                                </div>
                                                <div>
                                                    <h2 className="font-display font-bold text-3xl text-white mb-2">{currentUser.name}</h2>
                                                    <p className="text-brand-400 font-mono text-sm">{currentUser.phone}</p>
                                                </div>
                                            </div>

                                            <div className="premium-panel p-8">
                                                <h3 className="text-gray-500 font-bold text-xs uppercase tracking-widest mb-6 border-b border-white/10 pb-4">Account Diagnostics</h3>
                                                <div className="space-y-4">
                                                    <div className="flex justify-between items-center bg-black/30 p-4 rounded-xl border border-white/5">
                                                        <span className="text-gray-400 text-sm">System Entry Date</span>
                                                        <span className="text-white font-mono text-sm">{currentUser.joined || 'Recent'}</span>
                                                    </div>
                                                    <div className="flex justify-between items-center bg-black/30 p-4 rounded-xl border border-white/5">
                                                        <span className="text-gray-400 text-sm">Generated Assets</span>
                                                        <span className="text-white font-bold">{userSites.length}</span>
                                                    </div>
                                                    <div className="pt-6 mt-6 border-t border-white/10 flex flex-col gap-3">
                                                        <button onClick={handleLogout} className="w-full bg-red-500/10 text-red-400 border border-red-500/20 hover:bg-red-500 hover:text-white py-4 rounded-xl font-bold text-xs tracking-widest transition uppercase">LOGOUT CURRENT SESSION</button>
                                                        <button onClick={handleDeleteAccount} className="w-full text-gray-500 hover:text-red-500 py-2 font-bold text-[10px] tracking-widest transition uppercase underline decoration-gray-700 hover:decoration-red-500 underline-offset-4">Delete Account Permanently</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div className="lg:col-span-1">
                                            <div className={`premium-panel p-8 h-full flex flex-col justify-center border ${isPro ? 'border-yellow-500/50 shadow-[0_0_30px_rgba(251,191,36,0.15)]' : 'border-white/10'}`}>
                                                <div className="text-center">
                                                    <h3 className="text-gray-500 font-bold text-xs uppercase tracking-widest mb-6 border-b border-white/10 pb-4 text-left">License Status</h3>
                                                    {isPermanentlyPro ? (
                                                        <div className="py-4">
                                                            <div className="inline-flex items-center gap-2 text-lg px-8 py-3 mb-4 animate-glow-pulse shadow-[0_0_30px_rgba(255,215,0,0.8)] !bg-gradient-to-r !from-[#FFF500] !to-[#FFB300] !text-black !border !border-[#FFE000] font-black uppercase tracking-widest rounded-lg">
                                                                ACTIVE PRO
                                                            </div>
                                                            <p className="text-gray-400 text-sm leading-relaxed mx-auto mt-4 mb-6">All enterprise architectures, infinite colors, and SEO engines are fully unlocked.</p>
                                                            
                                                            <ul className="text-left space-y-3 mt-6 border-t border-white/10 pt-6">
                                                                <li className="flex items-start gap-3 text-xs text-gray-300 leading-snug"><i className="fa-solid fa-check text-yellow-400 mt-0.5"></i> Full Access to 12+ Premium Architectures</li>
                                                                <li className="flex items-start gap-3 text-xs text-gray-300 leading-snug"><i className="fa-solid fa-check text-yellow-400 mt-0.5"></i> Zero DBP Watermarks on HTML Export</li>
                                                                <li className="flex items-start gap-3 text-xs text-gray-300 leading-snug"><i className="fa-solid fa-check text-yellow-400 mt-0.5"></i> Custom Google Maps Integrations</li>
                                                                <li className="flex items-start gap-3 text-xs text-gray-300 leading-snug"><i className="fa-solid fa-check text-yellow-400 mt-0.5"></i> Advanced SEO Meta Tag Injection</li>
                                                                <li className="flex items-start gap-3 text-xs text-gray-300 leading-snug"><i className="fa-solid fa-check text-yellow-400 mt-0.5"></i> Unlocked Custom Hex/RGB Design Engine</li>
                                                            </ul>
                                                        </div>
                                                    ) : isTrialActive ? (
                                                        <div className="py-4">
                                                            <div className="inline-flex items-center gap-2 text-lg px-8 py-3 mb-2 animate-glow-pulse shadow-[0_0_30px_rgba(255,215,0,0.8)] !bg-gradient-to-r !from-[#FFF500] !to-[#FFB300] !text-black !border !border-[#FFE000] font-black uppercase tracking-widest rounded-lg">
                                                                PRO TRIAL
                                                            </div>
                                                            <p className="text-yellow-400 font-bold mb-4 text-sm tracking-widest uppercase">Expires in: {getTrialTimeLeft()}</p>
                                                            <p className="text-gray-400 text-sm leading-relaxed mx-auto mt-4 mb-6">All enterprise architectures, infinite colors, and SEO engines are fully unlocked for your trial period.</p>
                                                            
                                                            <ul className="text-left space-y-3 mt-6 border-t border-white/10 pt-6">
                                                                <li className="flex items-start gap-3 text-xs text-gray-300 leading-snug"><i className="fa-solid fa-check text-yellow-400 mt-0.5"></i> Full Access to 12+ Premium Architectures</li>
                                                                <li className="flex items-start gap-3 text-xs text-gray-300 leading-snug"><i className="fa-solid fa-check text-yellow-400 mt-0.5"></i> Zero DBP Watermarks on HTML Export</li>
                                                                <li className="flex items-start gap-3 text-xs text-gray-300 leading-snug"><i className="fa-solid fa-check text-yellow-400 mt-0.5"></i> Custom Google Maps Integrations</li>
                                                                <li className="flex items-start gap-3 text-xs text-gray-300 leading-snug"><i className="fa-solid fa-check text-yellow-400 mt-0.5"></i> Advanced SEO Meta Tag Injection</li>
                                                                <li className="flex items-start gap-3 text-xs text-gray-300 leading-snug"><i className="fa-solid fa-check text-yellow-400 mt-0.5"></i> Unlocked Custom Hex/RGB Design Engine</li>
                                                            </ul>
                                                            <button onClick={() => setView('pricing')} className="w-full btn-shine py-4 rounded-xl text-xs font-bold tracking-widest flex justify-center items-center gap-2 mt-6">
                                                                <i className="fa-solid fa-crown"></i> SECURE PERMANENT UPGRADE
                                                            </button>
                                                        </div>
                                                    ) : canRedeemTrial ? (
                                                        <div className="py-2">
                                                            <div className="inline-block bg-gray-800 text-gray-400 font-bold text-xs px-3 py-1 rounded mb-4 tracking-widest uppercase border border-white/10">FREE TIER</div>
                                                            <p className="text-gray-400 text-sm mb-4 leading-relaxed mx-auto">Try all features free for 7 days.</p>
                                                            <button onClick={handleRedeemTrial} className="w-full bg-gradient-to-r from-yellow-500 to-yellow-600 text-black py-4 rounded-xl text-xs font-bold tracking-widest flex justify-center items-center gap-2 mb-3 shadow-[0_0_15px_rgba(234,179,8,0.4)] hover:scale-105 transition transform">
                                                                <i className="fa-solid fa-gift text-lg"></i> REDEEM 1-WEEK FREE TRIAL
                                                            </button>
                                                            <button onClick={handlePaymentInit} className="w-full btn-shine py-3 rounded-xl text-xs font-bold tracking-widest flex justify-center items-center gap-2 opacity-90 hover:opacity-100 transition">
                                                                <i className="fa-solid fa-crown"></i> SECURE UPGRADE
                                                            </button>
                                                        </div>
                                                    ) : (
                                                        <div className="py-2">
                                                            <div className="inline-block bg-gray-800 text-gray-400 font-bold text-xs px-3 py-1 rounded mb-4 tracking-widest uppercase border border-white/10">FREE TIER</div>
                                                            <p className="text-red-400 text-sm mb-8 leading-relaxed mx-auto">Free trial expired. Upgrade to PRO to unlock all templates, custom colors, SEO tags, and remove watermarks.</p>
                                                            <button onClick={handlePaymentInit} className="w-full btn-shine py-4 rounded-xl text-xs font-bold tracking-widest flex justify-center items-center gap-2">
                                                                <i className="fa-solid fa-crown"></i> SECURE UPGRADE
                                                            </button>
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {view === 'admin' && isAdmin && (
                            <div className="flex-1 h-full overflow-y-auto p-6 lg:p-12 animate-fade-up w-full">
                                <div className="max-w-7xl mx-auto w-full">
                                    <div className="flex justify-between items-end mb-10 border-b border-white/10 pb-6">
                                        <div><h1 className="font-display font-bold text-4xl text-white flex items-center gap-4">System Admin <span className="pro-badge text-xs !bg-gradient-to-r !from-red-500 !to-red-700 !text-white !shadow-[0_0_15px_rgba(239,68,68,0.5)]">ROOT</span></h1><p className="text-gray-400 mt-2">Total control over platform architecture.</p></div>
                                    </div>
                                    
                                    <div className="grid grid-cols-2 md:grid-cols-4 gap-6 mb-10">
                                        <div className="premium-panel p-6"><div className="text-4xl font-display font-bold text-white mb-1">{users.length}</div><div className="text-xs font-bold text-gray-500 tracking-widest uppercase">Total Users</div></div>
                                        <div className="premium-panel p-6"><div className="text-4xl font-display font-bold text-brand-400 mb-1">{users.filter(u=>u.isPro).length}</div><div className="text-xs font-bold text-gray-500 tracking-widest uppercase">PRO Members</div></div>
                                        <div className="premium-panel p-6 md:col-span-2"><div className="text-4xl font-display font-bold text-white mb-1">₹{(users.filter(u=>u.isPro).length * 499).toLocaleString()}</div><div className="text-xs font-bold text-gray-500 tracking-widest uppercase">Estimated ARR</div></div>
                                    </div>

                                    <div className="grid lg:grid-cols-2 gap-8">
                                        <div className="premium-panel p-8">
                                            <h3 className="font-display font-bold text-xl text-white mb-6 flex items-center gap-3"><i className="fa-solid fa-users text-brand-400"></i> User Database</h3>
                                            <div className="space-y-4 max-h-[500px] overflow-y-auto pr-2">
                                                {users.length === 0 ? <p className="text-gray-500 italic">No users yet.</p> : users.map(u => (
                                                    <div key={u.phone} className="flex justify-between items-center bg-black/50 p-5 rounded-2xl border border-white/5 hover:border-white/10 transition">
                                                        <div>
                                                            <div className="font-bold text-white text-lg flex items-center gap-3">{u.name} {u.isPro && <span className="pro-badge text-[8px] px-2 py-0.5">PRO</span>}</div>
                                                            <div className="text-xs text-gray-500 font-mono mt-2"><i className="fa-solid fa-phone text-[10px] mr-1"></i> {u.phone} <span className="mx-2">•</span> {u.joined}</div>
                                                        </div>
                                                        <div className="flex gap-2">
                                                            <button onClick={() => adminTogglePro(u.phone)} className={`px-4 py-2 rounded-lg text-xs font-bold tracking-widest transition ${u.isPro ? 'bg-orange-500/10 text-orange-400 border border-orange-500/20 hover:bg-orange-500/20' : 'bg-brand-500/10 text-brand-400 border border-brand-500/20 hover:bg-brand-500/20'}`}>
                                                                {u.isPro ? 'REVOKE' : 'GRANT'}
                                                            </button>
                                                            <button onClick={() => adminDeleteUser(u.phone)} className="px-4 py-2 bg-red-500/10 text-red-500 rounded-lg text-xs font-bold border border-red-500/20 hover:bg-red-500 hover:text-white transition"><i className="fa-solid fa-trash"></i></button>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                        <div className="premium-panel p-8">
                                            <h3 className="font-display font-bold text-xl text-white mb-6 flex items-center gap-3"><i className="fa-solid fa-server text-brand-400"></i> Transaction Logs</h3>
                                            <div className="space-y-4 max-h-[500px] overflow-y-auto pr-2">
                                                {requests.length === 0 ? <p className="text-gray-500 text-sm italic">No recent transactions.</p> : requests.slice().reverse().map(r => (
                                                    <div key={r.firebaseId} className="bg-black/50 p-5 rounded-2xl border border-white/5 flex flex-col gap-3">
                                                        <div className="flex justify-between items-center"><span className="text-xs font-mono text-gray-500">ID: {r.id}</span><span className="text-[10px] bg-green-500/10 text-green-400 border border-green-500/20 px-2 py-1 rounded font-bold uppercase tracking-widest">{r.status}</span></div>
                                                        <div className="text-sm text-white font-medium">{r.type} <br/><span className="text-gray-500 font-light mt-1 inline-block">Authorized by {r.user} ({r.phone})</span></div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
